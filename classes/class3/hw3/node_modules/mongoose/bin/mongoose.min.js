!function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var f=r[s]={exports:{}};e[s][0].call(f.exports,function(t){var r=e[s][1][t];return i(r?r:t)},f,f.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){(function(n){r.Error=t("./error"),r.Schema=t("./schema"),r.Types=t("./types"),r.VirtualType=t("./virtualtype"),r.SchemaType=t("./schematype.js"),r.utils=t("./utils.js"),r.Document=t("./document_provider.js")(),"undefined"!=typeof window&&(window.mongoose=e.exports,window.Buffer=n)}).call(this,t("buffer").Buffer)},{"./document_provider.js":5,"./error":8,"./schema":19,"./schematype.js":30,"./types":36,"./utils.js":38,"./virtualtype":39,buffer:40}],2:[function(t,e,r){function n(t,e,r,i,h){if(!(this instanceof n))return new n(t,e,r,i,h);if(!c.isObject(e)||e instanceof u||(e=new u(e)),e=this.schema||e,!this.schema&&e.options._id&&(t=t||{},void 0===t._id&&(t._id=new f)),!e)throw new a.MissingSchemaError;this.$__setSchema(e),this.$__=new p,this.$__.emitter=new o,this.isNew=!0,this.errors=void 0,"boolean"==typeof r?(this.$__.strictMode=r,r=void 0):(this.$__.strictMode=this.schema.options&&this.schema.options.strict,this.$__.selected=r);for(var l=this.schema.requiredPaths(),d=0;d<l.length;++d)this.$__.activePaths.require(l[d]);s.call(this,0),this._doc=this.$__buildDoc(t,r,i),!h&&t&&this.init(t),this.$__registerHooksFromSchema();for(var y in e.methods)this[y]=e.methods[y];for(var g in e.statics)this[g]=e.statics[g]}{var i=t("./document"),o=t("events").EventEmitter,s=o.prototype.setMaxListeners,a=t("./error"),u=(t("./schema/mixed"),t("./schema")),f=t("./types/objectid"),c=(t("./schematype").ValidatorError,t("./utils")),h=(c.clone,c.isMongooseObject,t("util").inspect,a.ValidationError),p=t("./internal");c.deepEqual,t("hooks"),t("./promise")}n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.ValidationError=h,e.exports=r=n},{"./document":4,"./error":8,"./internal":17,"./promise":18,"./schema":19,"./schema/mixed":26,"./schematype":30,"./types/objectid":37,"./utils":38,events:44,hooks:49,util:48}],3:[function(t,e){var r=t("./utils"),n=t("./schema/index"),i=e.exports=function(t,e){for(var o,s,a,u,f,c,h=Object.keys(e),p=h.length;p--;)if(u=h[p],c=e[u],"$or"===u||"$nor"===u||"$and"===u)for(var l=c.length;l--;)c[l]=i(t,c[l]);else{if("$where"===u){if(f=typeof c,"string"!==f&&"function"!==f)throw new Error("Must have a string or function for $where");"function"===f&&(e[u]=c.toString());continue}if(!t)continue;if(s=t.path(u)){if(null===c||void 0===c)continue;if("Object"===c.constructor.name)if(o=Object.keys(c).some(function(t){return"$"===t.charAt(0)&&"$id"!==t&&"$ref"!==t})){for(var d,y=Object.keys(c),l=y.length;l--;)if(d=y[l],a=c[d],"$exists"!==d){if("$type"!==d)"$not"===d?i(t,a):c[d]=s.castForQuery(d,a);else if("number"!=typeof a)throw new Error("$type parameter must be Number")}else if("boolean"!=typeof a)throw new Error("$exists parameter must be Boolean")}else e[u]=s.castForQuery(c);else e[u]=s.castForQuery(c)}else{for(var g,_,m,v=u.split("."),b=v.length;b--&&(g=v.slice(0,b).join("."),!(s=t.path(g))););if(s){s.caster&&s.caster.schema?(m={},_=v.slice(b).join("."),m[_]=c,e[u]=i(s.caster.schema,m)[_]):e[u]=c;continue}if(r.isObject(c)){var w=c.$near?"$near":c.$nearSphere?"$nearSphere":c.$within?"$within":c.$geoIntersects?"$geoIntersects":"";if(!w)continue;var O=new n.Number("__QueryCasting__"),B=c[w];if(c.$maxDistance&&(c.$maxDistance=O.castForQuery(c.$maxDistance)),"$within"==w){var A=B.$center||B.$centerSphere||B.$box||B.$polygon;if(!A)throw new Error("Bad $within paramater: "+JSON.stringify(c));B=A}else"$near"==w&&"string"==typeof B.type&&Array.isArray(B.coordinates)?B=B.coordinates:("$near"==w||"$nearSphere"==w||"$geoIntersects"==w)&&B.$geometry&&"string"==typeof B.$geometry.type&&Array.isArray(B.$geometry.coordinates)&&(B=B.$geometry.coordinates);!function t(e){if(Array.isArray(e))e.forEach(function(n,i){return Array.isArray(n)||r.isObject(n)?t(n):void(e[i]=O.castForQuery(n))});else for(var n=Object.keys(e),i=n.length;i--;){var o=n[i],s=e[o];Array.isArray(s)||r.isObject(s)?(t(s),e[o]=s):e[o]=O.castForQuery(s)}}(B)}}}return e}},{"./schema/index":25,"./utils":38}],4:[function(t,e,r){(function(n,i){function o(t,e,r){this.$__=new E,this.$__.emitter=new y,this.isNew=!0,this.errors=void 0;var n=this.schema;"boolean"==typeof e?(this.$__.strictMode=e,e=void 0):(this.$__.strictMode=n.options&&n.options.strict,this.$__.selected=e);for(var i=n.requiredPaths(),o=0;o<i.length;++o)this.$__.activePaths.require(i[o]);if(this.$__.emitter.setMaxListeners(0),this._doc=this.$__buildDoc(t,e,r),t&&this.set(t,void 0,!0),!n.options.strict&&t){var s=this,a=Object.keys(this._doc);a.forEach(function(t){t in n.tree||f(t,null,s)})}this.$__registerHooksFromSchema()}function s(t,e,r,n){n=n||"";for(var i,o,a,u=Object.keys(e),f=u.length;f--;)if(a=u[f],o=n+a,i=t.schema.path(o),i||!b.isObject(e[a])||e[a].constructor&&"Object"!=b.getFunctionName(e[a].constructor)){if(null===e[a])r[a]=null;else if(void 0!==e[a])if(i)try{r[a]=i.cast(e[a],t,!0)}catch(e){t.invalidate(e.path,new v({path:e.path,message:e.message,type:"cast",value:e.value}))}else r[a]=e[a];t.$__.activePaths.init(o)}else r[a]||(r[a]={}),s(t,e[a],r[a],o+".")}function a(t,e,r){for(var n,i,o=Object.keys(t),s=o.length;s--;)i=o[s],n=t[i],f(i,"Object"!==b.getFunctionName(n.constructor)||!Object.keys(n).length||n.type&&!n.type.type?null:n,e,r,o)}function u(t){var e={};return Object.getOwnPropertyNames(t).forEach(function(r){e[r]=Object.getOwnPropertyDescriptor(t,r),e[r].enumerable=!1}),e}function f(t,e,r,n,i){var n=n||"",s=(n?n+".":"")+t;e?Object.defineProperty(r,t,{enumerable:!0,configurable:!0,get:function(){if(this.$__.getters||(this.$__.getters={}),!this.$__.getters[s]){var t=Object.create(Object.getPrototypeOf(this),u(this));n||(t.$__.scope=this);for(var r=0,o=i.length;o>r;++r)Object.defineProperty(t,i[r],{enumerable:!1,writable:!0,configurable:!0,value:void 0});t.toObject=function(){return this.get(s)},a(e,t,s),this.$__.getters[s]=t}return this.$__.getters[s]},set:function(t){return t instanceof o&&(t=t.toObject()),(this.$__.scope||this).set(s,t)}}):Object.defineProperty(r,t,{enumerable:!0,configurable:!0,get:function(){return this.get.call(this.$__.scope||this,s)},set:function(t){return this.set.call(this.$__.scope||this,s,t)}})}function c(t){for(var e,r,n,i=Object.keys(t),o=i.length;o--;)r=i[o],n=t[r],b.isObject(n)&&(t[r]=c(n)),void 0!==t[r]?e=!0:delete t[r];return e?t:void 0}function h(t,e,r,n){for(var i,o=t.schema,s=Object.keys(o[r]),a=s.length;a--;){i=s[a];for(var u,f=i.split("."),c=f.length,h=c-1,p=e,l=0;c>l;++l)u=f[l],l===h?p[u]=w(t.get(i),n):p=p[u]||(p[u]={})}return e}var p,l,d,y=t("events").EventEmitter,g=(y.prototype.setMaxListeners,t("./error")),_=t("./schema/mixed"),m=t("./schema"),v=(t("./types/objectid"),t("./schematype").ValidatorError),b=t("./utils"),w=b.clone,O=b.isMongooseObject,B=t("util").inspect,A=g.ValidationError,E=t("./internal"),S=b.deepEqual,N=t("hooks"),T=t("./promise");b.each(["on","once","emit","listeners","removeListener","setMaxListeners","removeAllListeners"],function(t){o.prototype[t]=function(){return this.$__.emitter[t].apply(this.$__.emitter,arguments)}}),o.prototype.constructor=o,o.prototype.schema,o.prototype.isNew,o.prototype.id,o.prototype.errors,o.prototype.$__buildDoc=function(t,e,r){var n,i,o,s={},a=this;if(e&&"Object"===b.getFunctionName(e.constructor))for(i=Object.keys(e),o=i.length;o--;)if("_id"!==i[o]){n=0===e[i[o]];break}for(var u=Object.keys(this.schema.paths),f=u.length,c=0;f>c;++c){var h=u[c];if("_id"==h){if(r)continue;if(t&&"_id"in t)continue}for(var p=this.schema.paths[h],l=h.split("."),d=l.length,y=d-1,g="",_=s,m=0;d>m;++m){var v,w=l[m];if(n){if(g+=w,g in e)break;g+="."}if(m===y)if(e)if(n){if(h in e)continue;v=p.getDefault(a,!0),"undefined"!=typeof v&&(_[w]=v,a.$__.activePaths.default(h))}else h in e&&(v=p.getDefault(a,!0),"undefined"!=typeof v&&(_[w]=v,a.$__.activePaths.default(h)));else v=p.getDefault(a,!0),"undefined"!=typeof v&&(_[w]=v,a.$__.activePaths.default(h));else _=_[w]||(_[w]={})}}return s},o.prototype.init=function(t,e,r){if("function"==typeof e&&(r=e,e=null),this.isNew=!1,t._id&&e&&e.populated&&e.populated.length)for(var n=String(t._id),i=0;i<e.populated.length;++i){var o=e.populated[i];this.populated(o.path,o._docs[n],o)}return s(this,t,this._doc),this.$__storeShard(),this.emit("init",this),r&&r(null),this},o.prototype.$__storeShard=function(){var t=this.schema.options.shardKey||this.schema.options.shardkey;if(t&&"Object"==b.getFunctionName(t.constructor))for(var e,r=this.$__.shardval={},n=Object.keys(t),i=n.length,o=0;i>o;++o)e=this.getValue(n[o]),r[n[o]]=O(e)?e.toObject({depopulate:!0}):null==e||!e.valueOf||e.constructor&&"Date"===b.getFunctionName(e.constructor)?e:e.valueOf()};for(var $ in N)o.prototype[$]=o[$]=N[$];o.prototype.update=function(){var t=b.args(arguments);return t.unshift({_id:this._id}),this.constructor.update.apply(this.constructor,t)},o.prototype.set=function(t,e,r,n){r&&"Object"==b.getFunctionName(r.constructor)&&(n=r,r=void 0);var i,s=n&&n.merge,a=r&&!0!==r,u=!0===r,f=n&&"strict"in n?n.strict:this.$__.strictMode;if(a&&(i=this.$__.adhocPaths||(this.$__.adhocPaths={}),i[t]=m.interpretAsType(t,r)),"string"!=typeof t){if(null!==t&&void 0!==t){var c=e?e+".":"";t instanceof o&&(t=t._doc);for(var h,p,l=Object.keys(t),d=l.length;d--;)if(p=l[d],h=this.schema.pathType(c+p),null==t[p]||!b.isObject(t[p])||t[p].constructor&&"Object"!=b.getFunctionName(t[p].constructor)||"virtual"==h||this.$__path(c+p)instanceof _||this.schema.paths[p]&&this.schema.paths[p].options.ref)if(f){if("real"===h||"virtual"===h)this.set(c+p,t[p],u);else if("throw"==f)throw new Error("Field `"+p+"` is not in schema.")}else void 0!==t[p]&&this.set(c+p,t[p],u);else this.set(t[p],c+p,u);return this}var y=t;t=e,e=y}var g=this.schema.pathType(t);if("nested"==g&&e&&b.isObject(e)&&(!e.constructor||"Object"==b.getFunctionName(e.constructor)))return s||this.setValue(t,null),this.set(e,t,u),this;var w,O=t.split(".");if("adhocOrUndefined"==g&&f){for(var B,d=0;d<O.length;++d){var A=O.slice(0,d+1).join(".");if(w=this.schema.path(A),w instanceof _){B=!0;break}}if(!B){if("throw"==f)throw new Error("Field `"+t+"` is not in schema.");return this}}else{if("virtual"==g)return w=this.schema.virtualpath(t),w.applySetters(e,this),this;w=this.$__path(t)}var E;if(O.length<=1)E=t;else{for(var d=0;d<O.length;++d){var A=O.slice(0,d+1).join(".");if(this.isDirectModified(A)||null===this.get(A)){E=A;break}}E||(E=t)}var S=u?void 0:this.getValue(t);if(!w||void 0===e)return this.$__set(E,t,u,O,w,e,S),this;var N=!0;try{w.options&&w.options.ref&&e instanceof o&&w.options.ref===e.constructor.modelName&&this.populated(t,e),e=w.applySetters(e,this,!1,S)}catch(t){this.invalidate(t.path,new v({path:t.path,message:t.message,type:"cast",value:t.value})),N=!1}return N&&this.$__set(E,t,u,O,w,e,S),this},o.prototype.$__shouldModify=function(t,e,r,n,i,o,s){return this.isNew?!0:void 0!==o||this.isSelected(e)?void 0===o&&e in this.$__.activePaths.states.default?!1:S(o,s||this.get(e))?!r&&null!=o&&e in this.$__.activePaths.states.default&&S(o,i.getDefault(this,r))?!0:!1:!0:!0},o.prototype.$__set=function(e,r,n,i,o,s){d=d||t("./types/embedded");var a=this.$__shouldModify.apply(this,arguments),u=this;a&&(this.markModified(e,s),l||(l=t("./types/array")),s&&s.isMongooseArray&&(s._registerAtomic("$set",s),this.$__.activePaths.forEach(function(t){0===t.indexOf(r+".")&&u.$__.activePaths.ignore(t)})));for(var f=this._doc,c=0,h=i.length;h>c;c++){var p=c+1,y=p===h;y?f[i[c]]=s:f=f[i[c]]&&"Object"===b.getFunctionName(f[i[c]].constructor)?f[i[c]]:f[i[c]]&&f[i[c]]instanceof d?f[i[c]]:f[i[c]]&&Array.isArray(f[i[c]])?f[i[c]]:f[i[c]]={}}},o.prototype.getValue=function(t){return b.getValue(t,this._doc)},o.prototype.setValue=function(t,e){return b.setValue(t,e,this._doc),this},o.prototype.get=function(t,e){var r;e&&(r=this.$__.adhocPaths||(this.$__.adhocPaths={}),r[t]=m.interpretAsType(t,e));for(var n=this.$__path(t)||this.schema.virtualpath(t),i=t.split("."),o=this._doc,s=0,a=i.length;a>s;s++)o=void 0===o||null===o?void 0:o[i[s]];return n&&(o=n.applyGetters(o,this)),o},o.prototype.$__path=function(t){var e=this.$__.adhocPaths,r=e&&e[t];return r?r:this.schema.path(t)},o.prototype.markModified=function(t){this.$__.activePaths.modify(t)},o.prototype.modifiedPaths=function(){var t=Object.keys(this.$__.activePaths.states.modify);return t.reduce(function(t,e){var r=e.split(".");return t.concat(r.reduce(function(t,e,n){return t.concat(r.slice(0,n).concat(e).join("."))},[]))},[])},o.prototype.isModified=function(t){return t?!!~this.modifiedPaths().indexOf(t):this.$__.activePaths.some("modify")},o.prototype.isDirectModified=function(t){return t in this.$__.activePaths.states.modify},o.prototype.isInit=function(t){return t in this.$__.activePaths.states.init},o.prototype.isSelected=function(t){if(this.$__.selected){if("_id"===t)return 0!==this.$__.selected._id;var e,r=Object.keys(this.$__.selected),n=r.length,i=!1;if(1===n&&"_id"===r[0])return 0===this.$__.selected._id;for(;n--;)if(e=r[n],"_id"!=e){i=!!this.$__.selected[e];break}if(t in this.$__.selected)return i;n=r.length;for(var o=t+".";n--;)if(e=r[n],"_id"!=e){if(0===e.indexOf(o))return i;if(0===o.indexOf(e+"."))return i}return!i}return!0},o.prototype.validate=function(t){function e(t){u[t]||(u[t]=!0,f++,n.nextTick(function(){var e=o.schema.path(t);if(!e)return--f||r();var n=o.getValue(t);e.doValidate(n,function(e){e&&o.invalidate(t,e,void 0,!0),--f||r()},o)}))}function r(){var t=o.$__.validationError;o.$__.validationError=void 0,o.emit("validate",o),t?s.reject(t):s.fulfill()}var o=this,s=new T(t),a=Object.keys(this.$__.activePaths.states.require).filter(function(t){return o.isSelected(t)||o.isModified(t)?!0:!1});if(a=a.concat(Object.keys(this.$__.activePaths.states.init)),a=a.concat(Object.keys(this.$__.activePaths.states.modify)),a=a.concat(Object.keys(this.$__.activePaths.states.default)),0===a.length)return n.nextTick(function(){r()}),s;for(var u={},f=0,c=0;c<a.length;++c){var h=a[c],p=o.getValue(h);if(p instanceof Array&&!i.isBuffer(p))for(var l=p.length,d=0;l>d;++d)a.push(h+"."+d)}return a.forEach(e),s},o.prototype.validateSync=function(){var t=this,e=Object.keys(this.$__.activePaths.states.require).filter(function(e){return t.isSelected(e)||t.isModified(e)?!0:!1});e=e.concat(Object.keys(this.$__.activePaths.states.init)),e=e.concat(Object.keys(this.$__.activePaths.states.modify)),e=e.concat(Object.keys(this.$__.activePaths.states.default));var r={};e.forEach(function(e){if(!r[e]){r[e]=!0;var n=t.schema.path(e);if(n){var i=t.getValue(e),o=n.doValidateSync(i,t);o&&t.invalidate(e,o,void 0,!0)}}});var n=t.$__.validationError;return t.$__.validationError=void 0,t.emit("validate",t),n},o.prototype.invalidate=function(t,e,r){this.$__.validationError||(this.$__.validationError=new A(this)),this.$__.validationError.errors[t]||(e&&"string"!=typeof e||(e=new v({path:t,message:e,type:"user defined",value:r})),this.$__.validationError!=e&&(this.$__.validationError.errors[t]=e))},o.prototype.$__reset=function(){var e=this;p||(p=t("./types/documentarray")),this.$__.activePaths.map("init","modify",function(t){return e.getValue(t)}).filter(function(t){return t&&t instanceof Array&&t.isMongooseDocumentArray&&t.length}).forEach(function(t){for(var e=t.length;e--;){var r=t[e];r&&r.$__reset()}}),this.$__dirty().forEach(function(t){var e=t.value;e&&e._atomics&&(e._atomics={})}),this.$__.activePaths.clear("modify"),this.$__.validationError=void 0,this.errors=void 0;var e=this;return this.schema.requiredPaths().forEach(function(t){e.$__.activePaths.require(t)}),this},o.prototype.$__dirty=function(){var t=this,e=this.$__.activePaths.map("modify",function(e){return{path:e,value:t.getValue(e),schema:t.$__path(e)}});e.sort(function(t,e){return t.path<e.path?-1:t.path>e.path?1:0});var r,n,i=[];return e.forEach(function(t){0!==t.path.indexOf(r)?(r=t.path+".",i.push(t),n=t):n.value&&n.value._atomics&&n.value.hasAtomics()&&(n.value._atomics={},n.value._atomics.$set=n.value)}),n=r=null,i},o.prototype.$__setSchema=function(t){a(t.tree,this),this.schema=t},o.prototype.$__getArrayPathsToValidate=function(){return p||(p=t("./types/documentarray")),this.$__.activePaths.map("init","modify",function(t){return this.getValue(t)}.bind(this)).filter(function(t){return t&&t instanceof Array&&t.isMongooseDocumentArray&&t.length}).reduce(function(t,e){return t.concat(e)},[]).filter(function(t){return t})},o.prototype.$__getAllSubdocs=function(){function e(t,r){var n=this[r];return n instanceof d&&t.push(n),n&&n.isMongooseDocumentArray&&n.forEach(function(r){r&&r._doc&&(r instanceof d&&t.push(r),t=Object.keys(r._doc).reduce(e.bind(r._doc),t))}),t}p||(p=t("./types/documentarray")),d=d||t("./types/embedded");var r=Object.keys(this._doc).reduce(e.bind(this),[]);return r},o.prototype.$__presaveValidate=function(){var t=this.$__getArrayPathsToValidate(),e=t.map(function(t){return t.$__presaveValidate()}),r=[this.$__.saveError].concat(e),n=r.filter(function(t){return t})[0];return this.$__.saveError=null,n},o.prototype.$__error=function(t){return this.$__.saveError=t,this},o.prototype.$__registerHooksFromSchema=function(){d=d||t("./types/embedded");var e=this,r=e.schema&&e.schema.callQueue;if(!r.length)return e;var n=r.reduce(function(t,e){var r=[].slice.call(e[1]),n="on"===e[0]?"post":r[0];return n in t||(t[n]=[]),t[n].push(r),t},{post:[]});return n.post.forEach(function(t){e.on.apply(e,t)}),delete n.post,Object.keys(n).forEach(function(t){if(~"set ".indexOf(t))return void n[t].forEach(function(t){e.pre.apply(e,t)});var r="$__original_"+t;e[r]=e[t],e[t]=function(){var t=[].slice.call(arguments),n=t.pop(),i=new T;return i.end(),"function"==typeof n&&i.onResolve(n),this instanceof d||i.hasRejectListeners()||i.onReject(e.$__handleReject.bind(e)),t.push(function(){return i.resolve.apply(i,arguments)}),e[r].apply(e,t),i},n[t].forEach(function(t){t[0]=r,e.pre.apply(e,t)})}),e},o.prototype.$__handleReject=function(t){if(this.listeners("error").length)this.emit("error",t);else if(this.constructor.listeners&&this.constructor.listeners("error").length)this.constructor.emit("error",t);else if(this.listeners&&this.listeners("error").length)this.emit("error",t);else{if(!this.db)throw t;this.db.listeners("error").length||(t.stack="No listeners detected, throwing. Consider adding an error listener to your connection.\n"+t.stack),this.db.emit("error",t)}},o.prototype.toObject=function(t){if(t&&t.depopulate&&!t._skipDepopulateTopLevel&&this.$__.wasPopulated)return w(this._id,t);t&&t._skipDepopulateTopLevel&&(t._skipDepopulateTopLevel=!1);var e=t;(!t||"Object"!=b.getFunctionName(t.constructor)||t&&t._useSchemaOptions)&&(t=this.schema.options.toObject?w(this.schema.options.toObject):{}),"minimize"in t||(t.minimize=this.schema.options.minimize),e||(t._useSchemaOptions=!0);var r=t.transform,n=w(this._doc,t);if((t.virtuals||t.getters&&!1!==t.virtuals)&&h(this,n,"virtuals",t),t.getters&&(h(this,n,"paths",t),t.minimize&&(n=c(n)||{})),!0===t.transform||this.schema.options.toObject&&t.transform){var i=t.json?this.schema.options.toJSON:this.schema.options.toObject;i&&(t.transform=i.transform)}else t.transform=r;if("function"==typeof t.transform){var o=t.transform(this,n,t);"undefined"!=typeof o&&(n=o)}return n},o.prototype.toJSON=function(t){return(!t||"Object"!=b.getFunctionName(t.constructor)||(!t||t.json)&&this.schema.options.toJSON)&&(t=this.schema.options.toJSON?w(this.schema.options.toJSON):{}),t.json=!0,this.toObject(t)},o.prototype.inspect=function(t){var e=t&&"Object"==b.getFunctionName(t.constructor)?t:this.schema.options.toObject?w(this.schema.options.toObject):{};return e.minimize=!1,B(this.toObject(e))},o.prototype.toString=o.prototype.inspect,o.prototype.equals=function(t){var e=this.get("_id"),r=t.get("_id");return e||r?e&&e.equals?e.equals(r):e===r:S(this,t)},o.prototype.populate=function(){if(0===arguments.length)return this;var t,e=this.$__.populate||(this.$__.populate={}),r=b.args(arguments);if("function"==typeof r[r.length-1]&&(t=r.pop()),r.length)for(var n=b.populate.apply(null,r),i=0;i<n.length;++i)e[n[i].path]=n[i];if(t){var o=b.object.vals(e);this.$__.populate=void 0,this.constructor.populate(this,o,t)}return this},o.prototype.execPopulate=function(){var t=new T,e=this;return this.populate(function(r){return r?t.reject(r):void t.fulfill(e)}),t},o.prototype.populated=function(t,e,r){if(null==e){if(!this.$__.populated)return void 0;var n=this.$__.populated[t];return n?n.value:void 0}return!0===e?this.$__.populated?this.$__.populated[t]:void 0:(this.$__.populated||(this.$__.populated={}),this.$__.populated[t]={value:e,options:r},e)},o.prototype.$__fullPath=function(t){return t||""},o.ValidationError=A,e.exports=r=o}).call(this,t("FWaASH"),t("buffer").Buffer)},{"./error":8,"./internal":17,"./promise":18,"./schema":19,"./schema/mixed":26,"./schematype":30,"./types/array":32,"./types/documentarray":34,"./types/embedded":35,"./types/objectid":37,"./utils":38,FWaASH:46,buffer:40,events:44,hooks:49,util:48}],5:[function(t,e){"use strict";var r=t("./document.js"),n=t("./browserDocument.js");e.exports=function(){return"undefined"!=typeof window&&"undefined"!=typeof document&&document===window.document?n:r}},{"./browserDocument.js":2,"./document.js":4}],6:[function(t,e,r){var n=t("mongodb/node_modules/bson").Binary;e.exports=r=n},{"mongodb/node_modules/bson":54}],7:[function(t,e,r){var n=t("mongodb/node_modules/bson").ObjectID;e.exports=r=n},{"mongodb/node_modules/bson":54}],8:[function(t,e,r){function n(t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),this.message=t,this.name="MongooseError"}n.prototype=Object.create(Error.prototype),n.prototype.constructor=Error,e.exports=r=n,n.messages=t("./error/messages"),n.Messages=n.messages,n.CastError=t("./error/cast"),n.ValidationError=t("./error/validation"),n.ValidatorError=t("./error/validator"),n.VersionError=t("./error/version"),n.OverwriteModelError=t("./error/overwriteModel"),n.MissingSchemaError=t("./error/missingSchema"),n.DivergentArrayError=t("./error/divergentArray")},{"./error/cast":9,"./error/divergentArray":10,"./error/messages":11,"./error/missingSchema":12,"./error/overwriteModel":13,"./error/validation":14,"./error/validator":15,"./error/version":16}],9:[function(t,e){function r(t,e,r){n.call(this,"Cast to "+t+' failed for value "'+e+'" at path "'+r+'"'),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),this.name="CastError",this.kind=t,this.value=e,this.path=r}var n=t("../error.js");r.prototype=Object.create(n.prototype),r.prototype.constructor=n,e.exports=r},{"../error.js":8}],10:[function(t,e){function r(t){var e="For your own good, using `document.save()` to update an array which was selected using an $elemMatch projection OR populated using skip, limit, query conditions, or exclusion of the _id field when the operation results in a $pop or $set of the entire array is not supported. The following path(s) would have been modified unsafely:\n  "+t.join("\n  ")+"\nUse Model.update() to update these arrays instead.";n.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),this.name="DivergentArrayError"}var n=t("../error.js");r.prototype=Object.create(n.prototype),r.prototype.constructor=n,e.exports=r},{"../error.js":8}],11:[function(t,e,r){var n=e.exports=r={};n.general={},n.general.default="Validator failed for path `{PATH}` with value `{VALUE}`",n.general.required="Path `{PATH}` is required.",n.Number={},n.Number.min="Path `{PATH}` ({VALUE}) is less than minimum allowed value ({MIN}).",n.Number.max="Path `{PATH}` ({VALUE}) is more than maximum allowed value ({MAX}).",n.Date={},n.Date.min="Path `{PATH}` ({VALUE}) is before minimum allowed value ({MIN}).",n.Date.max="Path `{PATH}` ({VALUE}) is after maximum allowed value ({MAX}).",n.String={},n.String.enum="`{VALUE}` is not a valid enum value for path `{PATH}`.",n.String.match="Path `{PATH}` is invalid ({VALUE})."},{}],12:[function(t,e){function r(t){var e="Schema hasn't been registered for model \""+t+'".\nUse mongoose.model(name, schema)';n.call(this,e),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),this.name="MissingSchemaError"}var n=t("../error.js");r.prototype=Object.create(n.prototype),r.prototype.constructor=n,e.exports=r},{"../error.js":8}],13:[function(t,e){function r(t){n.call(this,"Cannot overwrite `"+t+"` model once compiled."),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),this.name="OverwriteModelError"}var n=t("../error.js");r.prototype=Object.create(n.prototype),r.prototype.constructor=n,e.exports=r},{"../error.js":8}],14:[function(t,e,r){function n(t){t&&"model"===t.constructor.name?i.call(this,t.constructor.modelName+" validation failed"):i.call(this,"Validation failed"),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),this.name="ValidationError",this.errors={},t&&(t.errors=this.errors)}var i=t("../error.js");n.prototype=Object.create(i.prototype),n.prototype.constructor=i,n.prototype.toString=function(){var t=this.name+": ",e=[];return Object.keys(this.errors).forEach(function(t){this!=this.errors[t]&&e.push(String(this.errors[t]))},this),t+e.join(", ")},e.exports=r=n},{"../error.js":8}],15:[function(t,e){function r(t){var e=t.message;e||(e=i.general.default),this.properties=t;var r=this.formatMessage(e,t);n.call(this,r),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),this.name="ValidatorError",this.kind=t.type,this.path=t.path,this.value=t.value}var n=t("../error.js"),i=n.messages;r.prototype=Object.create(n.prototype),r.prototype.constructor=n,r.prototype.formatMessage=function(t,e){for(var r=Object.keys(e),n=0;n<r.length;++n){var i=r[n];"message"!==i&&(t=t.replace("{"+i.toUpperCase()+"}",e[i]))}return t},r.prototype.toString=function(){return this.message},e.exports=r},{"../error.js":8}],16:[function(t,e){function r(){n.call(this,"No matching document found."),Error.captureStackTrace&&Error.captureStackTrace(this,arguments.callee),this.name="VersionError"}var n=t("../error.js");r.prototype=Object.create(n.prototype),r.prototype.constructor=n,e.exports=r},{"../error.js":8}],17:[function(t,e,r){function n(){this.strictMode=void 0,this.selected=void 0,this.shardval=void 0,this.saveError=void 0,this.validationError=void 0,this.adhocPaths=void 0,this.removing=void 0,this.inserting=void 0,this.version=void 0,this.getters={},this._id=void 0,this.populate=void 0,this.populated=void 0,this.wasPopulated=!1,this.scope=void 0,this.activePaths=new o,this.ownerDocument=void 0,this.fullPath=void 0}var i=t("./statemachine"),o=i.ctor("require","modify","init","default","ignore");e.exports=r=n},{"./statemachine":31}],18:[function(t,e){function r(t){n.call(this,t)}var n=t("mpromise"),i=t("util");r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),r.SUCCESS="complete",r.FAILURE="err",r.prototype.error=function(t){return t instanceof Error||(t instanceof Object&&(t=i.inspect(t)),t=new Error(t)),this.reject(t)},r.prototype.resolve=function(t){return t?this.error(t):this.fulfill.apply(this,Array.prototype.slice.call(arguments,1))},r.prototype.addBack=r.prototype.onResolve,r.prototype.complete=n.prototype.fulfill,r.prototype.addCallback=r.prototype.onFulfill,r.prototype.addErrback=r.prototype.onReject,e.exports=r},{mpromise:67,util:48}],19:[function(t,e,r){(function(n){function i(t,e){if(!(this instanceof i))return new i(t,e);this.paths={},this.subpaths={},this.virtuals={},this.nested={},this.inherits={},this.callQueue=[],this._indexes=[],this.methods={},this.statics={},this.tree={},this._requiredpaths=void 0,this.discriminatorMapping=void 0,this._indexedpaths=void 0,this.s={hooks:new h,queryHooks:p},this.options=this.defaultOptions(e),t&&this.add(t);var r=t&&t._id&&c.isObject(t._id),n=!this.paths._id&&!this.options.noId&&this.options._id&&!r;n&&this.add({_id:{type:i.ObjectId,auto:!0}});var s=!this.paths.id&&!this.options.noVirtualId&&this.options.id;s&&this.virtual("id").get(o);var a=this.options.timestamps;if(a){var u=a.createdAt||"createdAt",f=a.updatedAt||"updatedAt",l={};l[f]=Date,this.paths[u]||(l[u]=Date),this.add(l),this.pre("save",function(t){var e=new Date;this[u]||(this[u]=n?this._id.getTimestamp():e),this[f]=this.isNew?this[u]:e,t()})}this.pre("validate",function(t){delete this.errors,t()})}function o(){return this.$__._id?this.$__._id:this.$__._id=null==this._id?null:String(this._id)}function s(t,e){var r=e.split(/\.(\d+)\.|\.(\d+)$/).filter(Boolean);if(r.length<2)return t.paths[r[0]];var n=t.path(r[0]);if(!n)return n;for(var i,o=r.length-1,s=1;s<r.length;++s){if(i=r[s],s===o&&n&&!n.schema&&!/\D/.test(i)){n=n instanceof a.Array?n.caster:void 0;break}if(/\D/.test(i)){if(!n||!n.schema){n=void 0;break}n=n.schema.path(i)}}return t.subpaths[e]=n}var a,u=t("events").EventEmitter,f=t("./virtualtype"),c=t("./utils"),h=t("kareem"),p={find:!0,findOne:!0};i.prototype=Object.create(u.prototype),i.prototype.constructor=i,i.prototype.paths,i.prototype.tree,i.prototype.defaultOptions=function(t){return t&&!1===t.safe&&(t.safe={w:0}),t&&t.safe&&0===t.safe.w&&(t.versionKey=!1),t=c.options({strict:!0,bufferCommands:!0,capped:!1,versionKey:"__v",discriminatorKey:"__t",minimize:!0,autoIndex:null,shardKey:null,read:null,validateBeforeSave:!0,noId:!1,_id:!0,noVirtualId:!1,id:!0},t),t.read&&(t.read=c.readPref(t.read)),t},i.prototype.add=function(t,e){e=e||"";for(var r=Object.keys(t),n=0;n<r.length;++n){var i=r[n];if(null==t[i])throw new TypeError("Invalid value for schema path `"+e+i+"`");if(Array.isArray(t[i])&&1===t[i].length&&null==t[i][0])throw new TypeError("Invalid value for schema Array path `"+e+i+"`");!c.isObject(t[i])||t[i].constructor&&"Object"!=c.getFunctionName(t[i].constructor)||t[i].type&&!t[i].type.type?this.path(e+i,t[i]):Object.keys(t[i]).length?(this.nested[e+i]=!0,this.add(t[i],e+i+".")):this.path(e+i,t[i])}},i.reserved=Object.create(null);var l=i.reserved;l.on=l.once=l.db=l.set=l.get=l.init=l.isNew=l.errors=l.schema=l.modelName=l.collection=l.toObject=l.save=l.validate=l.emit=l._pres=l._posts=1,i.prototype.path=function(t,e){if(void 0==e)return this.paths[t]?this.paths[t]:this.subpaths[t]?this.subpaths[t]:/\.\d+\.?.*$/.test(t)?s(this,t):void 0;if(l[t])throw new Error("`"+t+"` may not be used as a schema pathname");var r=t.split(/\./),n=r.pop(),o=this.tree;return r.forEach(function(e,n){if(o[e]||(o[e]={}),"object"!=typeof o[e]){var i="Cannot set nested path `"+t+"`. Parent path `"+r.slice(0,n).concat([e]).join(".")+"` already set to type "+o[e].name+".";throw new Error(i)}o=o[e]}),o[n]=c.clone(e),this.paths[t]=i.interpretAsType(t,e),this},i.interpretAsType=function(t,e){if(e.constructor){var r=c.getFunctionName(e.constructor);"Object"!=r&&(e={type:e})}var o=e.type&&!e.type.type?e.type:{};if("Object"==c.getFunctionName(o.constructor)||"mixed"==o)return new a.Mixed(t,e);if(Array.isArray(o)||Array==o||"array"==o){var s=Array==o||"array"==o?e.cast:o[0];if(s instanceof i)return new a.DocumentArray(t,s,e);if("string"==typeof s)s=a[s.charAt(0).toUpperCase()+s.substring(1)];else if(s&&(!s.type||s.type.type)&&"Object"==c.getFunctionName(s.constructor)&&Object.keys(s).length)return new a.DocumentArray(t,new i(s),e);return new a.Array(t,s||a.Mixed,e)}var u;if(u=n.isBuffer(o)?"Buffer":"string"==typeof o?o:o.schemaName||c.getFunctionName(o),u&&(u=u.charAt(0).toUpperCase()+u.substring(1)),void 0==a[u])throw new TypeError("Undefined type `"+u+"` at `"+t+"`\n  Did you try nesting Schemas? You can only nest using refs or arrays.");return new a[u](t,e)},i.prototype.eachPath=function(t){for(var e=Object.keys(this.paths),r=e.length,n=0;r>n;++n)t(e[n],this.paths[e[n]]);return this},i.prototype.requiredPaths=function(){if(this._requiredpaths)return this._requiredpaths;
for(var t=Object.keys(this.paths),e=t.length,r=[];e--;){var n=t[e];this.paths[n].isRequired&&r.push(n)}return this._requiredpaths=r},i.prototype.indexedPaths=function(){return this._indexedpaths?this._indexedpaths:this._indexedpaths=this.indexes()},i.prototype.pathType=function(t){return t in this.paths?"real":t in this.virtuals?"virtual":t in this.nested?"nested":t in this.subpaths?"real":/\.\d+\.|\.\d+$/.test(t)&&s(this,t)?"real":"adhocOrUndefined"},i.prototype.queue=function(t,e){return this.callQueue.push([t,e]),this},i.prototype.pre=function(){var t=arguments[0];return p[t]?(this.s.hooks.pre.apply(this.s.hooks,arguments),this):this.queue("pre",arguments)},i.prototype.post=function(t,e){return p[t]?(this.s.hooks.post.apply(this.s.hooks,arguments),this):e.length<2?this.queue("on",arguments):this.queue("post",[arguments[0],function(t){e.call(this,this,t)}])},i.prototype.plugin=function(t,e){return t(this,e),this},i.prototype.method=function(t,e){if("string"!=typeof t)for(var r in t)this.methods[r]=t[r];else this.methods[t]=e;return this},i.prototype.static=function(t,e){if("string"!=typeof t)for(var r in t)this.statics[r]=t[r];else this.statics[t]=e;return this},i.prototype.index=function(t,e){return e||(e={}),e.expires&&c.expires(e),this._indexes.push([t,e]),this},i.prototype.set=function(t,e,r){if(1===arguments.length)return this.options[t];switch(t){case"read":this.options[t]=c.readPref(e,r);break;case"safe":this.options[t]=!1===e?{w:0}:e;break;default:this.options[t]=e}return this},i.prototype.get=function(t){return this.options[t]};var d="2d 2dsphere hashed text".split(" ");Object.defineProperty(i,"indexTypes",{get:function(){return d},set:function(){throw new Error("Cannot overwrite Schema.indexTypes")}}),i.prototype.indexes=function(){"use strict";function t(o,s){if(!~n.indexOf(o)){n.push(o),s=s||"";for(var u,f,h,p,l,d,y,g=Object.keys(o.paths),_=0;_<g.length;++_)u=g[_],f=o.paths[u],f instanceof a.DocumentArray?t(f.schema,u+"."):(h=f._index,!1!==h&&null!=h&&(p={},l=c.isObject(h),d=l?h:{},y="string"==typeof h?h:l?h.type:!1,p[s+u]=y&&~i.indexTypes.indexOf(y)?y:1,delete d.type,"background"in d||(d.background=!0),r.push([p,d])));s?e(o,s):(o._indexes.forEach(function(t){"background"in t[1]||(t[1].background=!0)}),r=r.concat(o._indexes))}}function e(t,e){var n,i,o,s,a,u,f=t._indexes,c=f.length,h=0;for(h=0;c>h;++h){for(n=f[h][0],s=Object.keys(n),o=s.length,i={},u=0;o>u;++u)a=s[u],i[e+a]=n[a];r.push([i,f[h][1]])}}var r=[],n=[];return t(this),r},i.prototype.virtual=function(t,e){var r=this.virtuals,n=t.split(".");return r[t]=n.reduce(function(r,i,o){return r[i]||(r[i]=o===n.length-1?new f(e,t):{}),r[i]},this.tree)},i.prototype.virtualpath=function(t){return this.virtuals[t]},e.exports=r=i,i.Types=a=t("./schema/index");r.ObjectId=a.ObjectId}).call(this,t("buffer").Buffer)},{"./schema/index":25,"./utils":38,"./virtualtype":39,buffer:40,events:44,kareem:50}],20:[function(t,e){function r(t,e,r){if(e){var n={};"Object"===m.getFunctionName(e.constructor)&&(e.type?(n=m.clone(e),delete n.type,e=e.type):e=g);var i="string"==typeof e?e:m.getFunctionName(e),o=i in l?l[i]:e;this.casterConstructor=o,this.caster=new o(null,n),this.caster instanceof y||(this.caster.path=t)}h.call(this,t,r);var s,a,u=this;this.defaultValue&&(s=this.defaultValue,a="function"==typeof s),this.default(function(){var t=a?s():s||[];return new d(t,u.path,this)})}function n(t){return l.Number.prototype.cast.call(this,t)}function i(t,e){e||(e=this),t.forEach(function(r,o){Array.isArray(r)?i(r,e):t[o]=n.call(e,r)})}function o(t){return Array.isArray(t)?(i(t,this),t):t&&t.$geometry?s(t,this):r.prototype.castForQuery.call(this,t)}function s(t,e){switch(t.$geometry.type){case"Polygon":case"LineString":case"Point":i(t.$geometry.coordinates,e)}return t.$maxDistance&&(t.$maxDistance=n.call(e,t.$maxDistance)),t}function a(t){var e=this;if(t.$maxDistance&&(t.$maxDistance=n.call(e,t.$maxDistance)),t.$box||t.$polygon){var r=t.$box?"$box":"$polygon";t[r].forEach(function(t){if(!Array.isArray(t)){var e="Invalid $within $box argument. Expected an array, received "+t;throw new TypeError(e)}t.forEach(function(e,r){t[r]=n.call(this,e)})})}else if(t.$center||t.$centerSphere){var r=t.$center?"$center":"$centerSphere";t[r].forEach(function(e,i){Array.isArray(e)?e.forEach(function(t,r){e[r]=n.call(this,t)}):t[r][i]=n.call(this,e)})}else t.$geometry&&s(t,this);return t}function u(t){return Array.isArray(t)||(t=[t]),t=t.map(function(t){if(m.isObject(t)){var e={};return e[this.path]=t,_(this.casterConstructor.schema,e)[this.path]}return t},this),this.castForQuery(t)}function f(t){return t.$in?(t.$in=this.castForQuery("$in",t.$in),t):_(this.casterConstructor.schema,t)}function c(t){var e=t.$geometry;if(e)return s(t,this),t}var h=t("../schematype"),p=h.CastError,l=(t("./number"),{Boolean:t("./boolean"),Date:t("./date"),Number:t("./number"),String:t("./string"),ObjectId:t("./objectid"),Buffer:t("./buffer")}),d=t("../types").Array,y=t("../types").Embedded,g=t("./mixed"),_=t("../cast"),m=t("../utils"),v=m.isMongooseObject;r.schemaName="Array",r.prototype=Object.create(h.prototype),r.prototype.constructor=r,r.prototype.checkRequired=function(t){return!(!t||!t.length)},r.prototype.applyGetters=function(t,e){return this.caster.options&&this.caster.options.ref?t:h.prototype.applyGetters.call(this,t,e)},r.prototype.cast=function(t,e,r){if(Array.isArray(t)){if(!t.length&&e)for(var n=e.schema.indexedPaths(),i=0,o=n.length;o>i;++i){var s=n[i][0][this.path];if("2dsphere"===s||"2d"===s)return}if(t&&t.isMongooseArray||(t=new d(t,this.path,e)),this.caster)try{for(var i=0,o=t.length;o>i;i++)t[i]=this.caster.cast(t[i],e,r)}catch(e){throw new p(e.type,t,this.path)}return t}return this.cast([t],e,r)},r.prototype.castForQuery=function(t,e){var r,n;if(2===arguments.length){if(r=this.$conditionalHandlers[t],!r)throw new Error("Can't use "+t+" with Array.");n=r.call(this,e)}else{n=t;var i=this.casterConstructor.prototype,o=i.castForQuery||i.cast,s=this.caster;Array.isArray(n)?n=n.map(function(t){return o&&(t=o.call(s,t)),v(t)?t.toObject():t}):o&&(n=o.call(s,n))}return n&&v(n)?n.toObject():n};var b=r.prototype.$conditionalHandlers={};b.$all=u,b.$options=String,b.$elemMatch=f,b.$geoIntersects=c,b.$or=b.$and=function(t){if(!Array.isArray(t))throw new TypeError("conditional $or/$and require array");for(var e=[],r=0;r<t.length;++r)e.push(_(this.casterConstructor.schema,t[r]));return e},b.$near=b.$nearSphere=o,b.$within=b.$geoWithin=a,b.$size=b.$maxDistance=n,b.$regex=b.$ne=b.$in=b.$nin=b.$gt=b.$gte=b.$lt=b.$lte=r.prototype.castForQuery,e.exports=r},{"../cast":3,"../schematype":30,"../types":36,"../utils":38,"./boolean":21,"./buffer":22,"./date":23,"./mixed":26,"./number":27,"./objectid":28,"./string":29}],21:[function(t,e){function r(t,e){i.call(this,t,e)}function n(t){var e=this;return t.map(function(t){return e.cast(t)})}{var i=t("../schematype");t("../utils")}r.schemaName="Boolean",r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.checkRequired=function(t){return t===!0||t===!1},r.prototype.cast=function(t){return null===t?t:"0"===t?!1:"true"===t?!0:"false"===t?!1:!!t},r.$conditionalHandlers={$in:n},r.prototype.castForQuery=function(t,e){var n;return 2===arguments.length?(n=r.$conditionalHandlers[t],n?n.call(this,e):this.cast(e)):this.cast(t)},e.exports=r},{"../schematype":30,"../utils":38}],22:[function(t,e){(function(r){function n(t,e){a.call(this,t,e,"Buffer")}function i(t){return this.castForQuery(t)}function o(t){var e=this;return t.map(function(t){return e.castForQuery(t)})}var s,a=t("../schematype"),u=a.CastError,f=t("../types").Buffer,c=f.Binary,h=t("../utils");n.schemaName="Buffer",n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.prototype.checkRequired=function(t,e){return a._isRef(this,t,e,!0)?null!=t:!(!t||!t.length)},n.prototype.cast=function(e,n,i){if(a._isRef(this,e,n,i)){if(null==e)return e;if(s||(s=t("./../document")),e instanceof s)return e.$__.wasPopulated=!0,e;if(r.isBuffer(e))return e;if(!h.isObject(e))throw new u("buffer",e,this.path);var o=n.$__fullPath(this.path),p=n.ownerDocument?n.ownerDocument():n,l=p.populated(o,!0),d=new l.options.model(e);return d.$__.wasPopulated=!0,d}if(e&&e._id&&(e=e._id),e&&e.isMongooseBuffer)return e;if(r.isBuffer(e))return e&&e.isMongooseBuffer||(e=new f(e,[this.path,n])),e;if(e instanceof c){var d=new f(e.value(!0),[this.path,n]);return d.subtype(e.sub_type),d}if(null===e)return e;var y=typeof e;if("string"==y||"number"==y||Array.isArray(e)){var d=new f(e,[this.path,n]);return d}throw new u("buffer",e,this.path)},n.prototype.$conditionalHandlers={$ne:i,$in:o,$nin:o,$gt:i,$lt:i,$gte:i,$lte:i},n.prototype.castForQuery=function(t,e){var r;if(2===arguments.length){if(r=this.$conditionalHandlers[t],!r)throw new Error("Can't use "+t+" with Buffer.");return r.call(this,e)}return e=t,this.cast(e).toObject()},e.exports=n}).call(this,t("buffer").Buffer)},{"../schematype":30,"../types":36,"../utils":38,"./../document":4,buffer:40}],23:[function(t,e){function r(t,e){o.call(this,t,e)}function n(t){return this.cast(t)}function i(t){var e=this;return t.map(function(t){return e.cast(t)})}var o=t("../schematype"),s=o.CastError,a=t("../error").messages,u=t("../utils");r.schemaName="Date",r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.expires=function(t){return this._index&&"Object"===this._index.constructor.name||(this._index={}),this._index.expires=t,u.expires(this._index),this},r.prototype.checkRequired=function(t){return t instanceof Date},r.prototype.min=function(t,e){if(this.minValidator&&(this.validators=this.validators.filter(function(t){return t.validator!=this.minValidator},this)),t){var r=e||a.Date.min;r=r.replace(/{MIN}/,t===Date.now?"Date.now()":this.cast(t).toString());var n=this;this.validators.push({validator:this.minValidator=function(e){var r=t===Date.now?t():n.cast(t);return null===e||e.valueOf()>=r.valueOf()},message:r,type:"min"})}return this},r.prototype.max=function(t,e){if(this.maxValidator&&(this.validators=this.validators.filter(function(t){return t.validator!=this.maxValidator},this)),t){var r=e||a.Date.max;r=r.replace(/{MAX}/,t===Date.now?"Date.now()":this.cast(t).toString());var n=this;this.validators.push({validator:this.maxValidator=function(e){var r=t===Date.now?t():n.cast(t);return null===e||e.valueOf()<=r.valueOf()},message:r,type:"max"})}return this},r.prototype.cast=function(t){if(null===t||""===t)return null;if(t instanceof Date)return t;var e;if(t instanceof Number||"number"==typeof t||String(t)==Number(t)?e=new Date(Number(t)):t.toString&&(e=new Date(t.toString())),"Invalid Date"!=e.toString())return e;throw new s("date",t,this.path)},r.prototype.$conditionalHandlers={$lt:n,$lte:n,$gt:n,$gte:n,$ne:n,$in:i,$nin:i,$all:i},r.prototype.castForQuery=function(t,e){var r;if(2!==arguments.length)return this.cast(t);if(r=this.$conditionalHandlers[t],!r)throw new Error("Can't use "+t+" with Date.");return r.call(this,e)},e.exports=r},{"../error":8,"../schematype":30,"../utils":38}],24:[function(t,e){function r(t,e,r){function n(){this.$__setSchema(e);for(var t in e.methods)this[t]=e.methods[t];a.apply(this,arguments)}n.prototype=a.prototype,n.schema=e;for(var i in e.statics)n[i]=e.statics[i];n.options=r,this.schema=e,o.call(this,t,n,r),this.schema=e;var u=this.path,f=this.defaultValue;this.default(function(){var t=f.call(this);return Array.isArray(t)||(t=[t]),new s(t,u,this)})}function n(t,e,r){if(!r||!e)return void 0;for(var n,i,o=t.path+".",s=Object.keys(e),a=s.length,u={};a--;)i=s[a],0===i.indexOf(o)&&(n||(n=!0),u[i.substring(o.length)]=e[i]);return n&&u||void 0}{var i=t("../schematype"),o=t("./array"),s=t("../types/documentarray"),a=t("../types/embedded");t("../document"),t("../utils.js")}r.schemaName="DocumentArray",r.prototype=Object.create(o.prototype),r.prototype.constructor=r,r.prototype.doValidate=function(t,e,r){i.prototype.doValidate.call(this,t,function(r){if(r)return e(r);var n,i=t&&t.length;if(!i)return e();for(var o=0,s=i;s>o;++o){var a=t[o];a?!function(){a.validate(function(t){return t&&!n?e(n=t):void(--i||e())})}(o):--i||e()}},r)},r.prototype.doValidateSync=function(t,e){var r=i.prototype.doValidateSync.call(this,t,e);if(r)return r;var n=t&&t.length,o=null;if(n){for(var s=0,a=n;a>s&&!o;++s){var u=t[s];if(u){var f=u.validateSync();f&&(o=f)}}return o}},r.prototype.cast=function(t,e,r,i){var o,u,f;if(!Array.isArray(t))return this.cast([t],e,r,i);if((!t||!t.isMongooseDocumentArray)&&(t=new s(t,this.path,e),i&&i._handlers))for(var c in i._handlers)e.removeListener(c,i._handlers[c]);for(f=t.length;f--;)if(!(t[f]instanceof a)&&t[f])if(r)o||(o=n(this,e.$__.selected,r)),u=new this.casterConstructor(null,t,!0,o),t[f]=u.init(t[f]);else{try{u=i.id(t[f]._id)}catch(t){}i&&u?u.set(t[f]):u=new this.casterConstructor(t[f],t),t[f]=u}return t},e.exports=r},{"../document":4,"../schematype":30,"../types/documentarray":34,"../types/embedded":35,"../utils.js":38,"./array":20}],25:[function(t,e,r){r.String=t("./string"),r.Number=t("./number"),r.Boolean=t("./boolean"),r.DocumentArray=t("./documentarray"),r.Array=t("./array"),r.Buffer=t("./buffer"),r.Date=t("./date"),r.ObjectId=t("./objectid"),r.Mixed=t("./mixed"),r.Oid=r.ObjectId,r.Object=r.Mixed,r.Bool=r.Boolean},{"./array":20,"./boolean":21,"./buffer":22,"./date":23,"./documentarray":24,"./mixed":26,"./number":27,"./objectid":28,"./string":29}],26:[function(t,e){function r(t,e){if(e&&e.default){var r=e.default;Array.isArray(r)&&0===r.length?e.default=Array:!e.shared&&i.isObject(r)&&0===Object.keys(r).length&&(e.default=function(){return{}})}n.call(this,t,e)}var n=t("../schematype"),i=t("../utils");r.schemaName="Mixed",r.prototype=Object.create(n.prototype),r.prototype.constructor=r,r.prototype.checkRequired=function(t){return void 0!==t&&null!==t},r.prototype.cast=function(t){return t},r.prototype.castForQuery=function(t,e){return 2===arguments.length?e:t},e.exports=r},{"../schematype":30,"../utils":38}],27:[function(t,e){(function(r){function n(t,e){a.call(this,t,e,"Number")}function i(t){return this.cast(t)}function o(t){var e=this;return t.map(function(t){return e.cast(t)})}var s,a=t("../schematype"),u=a.CastError,f=t("../error").messages,c=t("../utils");n.schemaName="Number",n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.prototype.checkRequired=function(t,e){return a._isRef(this,t,e,!0)?null!=t:"number"==typeof t||t instanceof Number},n.prototype.min=function(t,e){if(this.minValidator&&(this.validators=this.validators.filter(function(t){return t.validator!=this.minValidator},this)),null!=t){var r=e||f.Number.min;r=r.replace(/{MIN}/,t),this.validators.push({validator:this.minValidator=function(e){return null===e||e>=t},message:r,type:"min"})}return this},n.prototype.max=function(t,e){if(this.maxValidator&&(this.validators=this.validators.filter(function(t){return t.validator!=this.maxValidator},this)),null!=t){var r=e||f.Number.max;r=r.replace(/{MAX}/,t),this.validators.push({validator:this.maxValidator=function(e){return null===e||t>=e},message:r,type:"max"})}return this},n.prototype.cast=function(e,n,i){if(a._isRef(this,e,n,i)){if(null==e)return e;if(s||(s=t("./../document")),e instanceof s)return e.$__.wasPopulated=!0,e;if("number"==typeof e)return e;if(r.isBuffer(e)||!c.isObject(e))throw new u("number",e,this.path);var o=n.$__fullPath(this.path),f=n.ownerDocument?n.ownerDocument():n,h=f.populated(o,!0),p=new h.options.model(e);return p.$__.wasPopulated=!0,p}var l=e&&e._id?e._id:e;if(!isNaN(l)){if(null===l)return l;if(""===l)return null;if("string"==typeof l&&(l=Number(l)),l instanceof Number)return l;if("number"==typeof l)return l;if(l.toString&&!Array.isArray(l)&&l.toString()==Number(l))return new Number(l)}throw new u("number",e,this.path)},n.prototype.$conditionalHandlers={$lt:i,$lte:i,$gt:i,$gte:i,$ne:i,$in:o,$nin:o,$mod:o,$all:o},n.prototype.castForQuery=function(t,e){var r;if(2===arguments.length){if(r=this.$conditionalHandlers[t],!r)throw new Error("Can't use "+t+" with Number.");return r.call(this,e)}return e=this.cast(t),null==e?e:e},e.exports=n}).call(this,t("buffer").Buffer)},{"../error":8,"../schematype":30,"../utils":38,"./../document":4,buffer:40}],28:[function(t,e){(function(r){function n(t,e){f.call(this,t,e,"ObjectID")}function i(t){return this.cast(t)}function o(t){var e=this;return t.map(function(t){return e.cast(t)})}function s(){return new h}function a(t){return this.$__._id=null,t}var u,f=t("../schematype"),c=f.CastError,h=t("../types/objectid"),p=t("../utils");n.schemaName="ObjectId",n.prototype=Object.create(f.prototype),n.prototype.constructor=n,n.prototype.auto=function(t){return t&&(this.default(s),this.set(a)),this},n.prototype.checkRequired=function(t,e){return f._isRef(this,t,e,!0)?null!=t:t instanceof h},n.prototype.cast=function(e,n,i){if(f._isRef(this,e,n,i)){if(null==e)return e;if(u||(u=t("./../document")),e instanceof u)return e.$__.wasPopulated=!0,e;if(e instanceof h)return e;if(r.isBuffer(e)||!p.isObject(e))throw new c("ObjectId",e,this.path);var o=n.$__fullPath(this.path),s=n.ownerDocument?n.ownerDocument():n,a=s.populated(o,!0),l=new a.options.model(e);return l.$__.wasPopulated=!0,l}if(null===e)return e;if(e instanceof h)return e;if(e._id&&e._id instanceof h)return e._id;if(e.toString)try{return h.createFromHexString(e.toString())}catch(t){throw new c("ObjectId",e,this.path)}throw new c("ObjectId",e,this.path)},n.prototype.$conditionalHandlers={$ne:i,$in:o,$nin:o,$gt:i,$lt:i,$gte:i,$lte:i,$all:o},n.prototype.castForQuery=function(t,e){var r;if(2===arguments.length){if(r=this.$conditionalHandlers[t],!r)throw new Error("Can't use "+t+" with ObjectId.");return r.call(this,e)}return this.cast(t)},e.exports=n}).call(this,t("buffer").Buffer)},{"../schematype":30,"../types/objectid":37,"../utils":38,"./../document":4,buffer:40}],29:[function(t,e){(function(r){function n(t,e){this.enumValues=[],this.regExp=null,a.call(this,t,e,"String")}function i(t){return this.castForQuery(t)}function o(t){var e=this;return t.map(function(t){return e.castForQuery(t)})}var s,a=t("../schematype"),u=a.CastError,f=t("../error").messages,c=t("../utils");n.schemaName="String",n.prototype=Object.create(a.prototype),n.prototype.constructor=n,n.prototype.enum=function(){if(this.enumValidator&&(this.validators=this.validators.filter(function(t){return t.validator!=this.enumValidator},this),this.enumValidator=!1),void 0===arguments[0]||!1===arguments[0])return this;var t,e;c.isObject(arguments[0])?(t=arguments[0].values,e=arguments[0].message):(t=arguments,e=f.String.enum);for(var r=0;r<t.length;r++)void 0!==t[r]&&this.enumValues.push(this.cast(t[r]));var n=this.enumValues;return this.enumValidator=function(t){return void 0===t||~n.indexOf(t)},this.validators.push({validator:this.enumValidator,message:e,type:"enum"}),this},n.prototype.lowercase=function(){return this.set(function(t,e){return"string"!=typeof t&&(t=e.cast(t)),t?t.toLowerCase():t})},n.prototype.uppercase=function(){return this.set(function(t,e){return"string"!=typeof t&&(t=e.cast(t)),t?t.toUpperCase():t})},n.prototype.trim=function(){return this.set(function(t,e){return"string"!=typeof t&&(t=e.cast(t)),t?t.trim():t})},n.prototype.match=function(t,e){var r=e||f.String.match,n=function(e){var r=null!=e&&""!==e?t.test(e):!0;return r};return this.validators.push({validator:n,message:r,type:"regexp"}),this},n.prototype.checkRequired=function(t,e){return a._isRef(this,t,e,!0)?null!=t:(t instanceof String||"string"==typeof t)&&t.length},n.prototype.cast=function(e,n,i){if(a._isRef(this,e,n,i)){if(null==e)return e;if(s||(s=t("./../document")),e instanceof s)return e.$__.wasPopulated=!0,e;if("string"==typeof e)return e;if(r.isBuffer(e)||!c.isObject(e))throw new u("string",e,this.path);var o=n.$__fullPath(this.path),f=n.ownerDocument?n.ownerDocument():n,h=f.populated(o,!0),p=new h.options.model(e);return p.$__.wasPopulated=!0,p}if(null===e)return e;if("undefined"!=typeof e){if(e._id&&"string"==typeof e._id)return e._id;if(e.toString)return e.toString()}throw new u("string",e,this.path)},n.prototype.$conditionalHandlers={$ne:i,$in:o,$nin:o,$gt:i,$lt:i,$gte:i,$lte:i,$all:o,$regex:i,$options:i},n.prototype.castForQuery=function(t,e){var r;if(2===arguments.length){if(r=this.$conditionalHandlers[t],!r)throw new Error("Can't use "+t+" with String.");return r.call(this,e)}return e=t,e instanceof RegExp?e:this.cast(e)},e.exports=n}).call(this,t("buffer").Buffer)},{"../error":8,"../schematype":30,"../utils":38,"./../document":4,buffer:40}],30:[function(t,e,r){(function(n){function i(t,e,r){this.path=t,this.instance=r,this.validators=[],this.setters=[],this.getters=[],this.options=e,this._index=null,this.selected;for(var n in e)if(this[n]&&"function"==typeof this[n]){if("index"==n&&this._index)continue;var i=Array.isArray(e[n])?e[n]:[e[n]];this[n].apply(this,i)}}var o=t("./utils"),s=t("./error"),a=s.messages,u=s.CastError,f=s.ValidatorError;i.prototype.default=function(t){return 1===arguments.length?(this.defaultValue="function"==typeof t?t:this.cast(t),this):(arguments.length>1&&(this.defaultValue=o.args(arguments)),this.defaultValue)},i.prototype.index=function(t){return this._index=t,o.expires(this._index),this},i.prototype.unique=function(t){return null==this._index||"boolean"==typeof this._index?this._index={}:"string"==typeof this._index&&(this._index={type:this._index}),this._index.unique=t,this},i.prototype.text=function(t){return null==this._index||"boolean"==typeof this._index?this._index={}:"string"==typeof this._index&&(this._index={type:this._index}),this._index.text=t,this},i.prototype.sparse=function(t){return null==this._index||"boolean"==typeof this._index?this._index={}:"string"==typeof this._index&&(this._index={type:this._index}),this._index.sparse=t,this},i.prototype.set=function(t){if("function"!=typeof t)throw new TypeError("A setter must be a function.");return this.setters.push(t),this},i.prototype.get=function(t){if("function"!=typeof t)throw new TypeError("A getter must be a function.");return this.getters.push(t),this},i.prototype.validate=function(t,e,r){if("function"==typeof t||t&&"RegExp"===o.getFunctionName(t.constructor)){var n;return e instanceof Object&&!r?(n=o.clone(e),n.message||(n.message=n.msg),n.validator=t):(e||(e=a.general.default),r||(r="user defined"),n={message:e,type:r,validator:t}),this.validators.push(n),this}var i,s,u;for(i=0,s=arguments.length;s>i;i++){if(u=arguments[i],!u||"Object"!==o.getFunctionName(u.constructor)){var f="Invalid validator. Received ("+typeof u+") "+u+". See http://mongoosejs.com/docs/api.html#schematype_SchemaType-validate";throw new Error(f)}this.validate(u.validator,u)}return this},i.prototype.required=function(t,e){if(!1===t)return this.validators=this.validators.filter(function(t){return t.validator!=this.requiredValidator},this),this.isRequired=!1,this;var r=this;this.isRequired=!0,this.requiredValidator=function(e){return"isSelected"in this&&!this.isSelected(r.path)&&!this.isModified(r.path)?!0:"function"==typeof t&&!t.apply(this)||r.checkRequired(e,this)},"string"==typeof t&&(e=t,t=void 0);var n=e||a.general.required;return this.validators.push({validator:this.requiredValidator,message:n,type:"required"}),this},i.prototype.getDefault=function(t,e){var r="function"==typeof this.defaultValue?this.defaultValue.call(t):this.defaultValue;return null!==r&&void 0!==r?this.cast(r,t,e):r},i.prototype.applySetters=function(t,e,r,n){if(i._isRef(this,t,e,r))return r?t:this.cast(t,e,r,n);var o=t,s=this.setters,a=s.length,u=this.caster;if(Array.isArray(o)&&u&&u.setters)for(var f=0;f<o.length;f++)o[f]=u.applySetters(o[f],e,r,n);if(!a)return null===o||void 0===o?o:this.cast(o,e,r,n);for(;a--;)o=s[a].call(e,o,this);return null===o||void 0===o?o:o=this.cast(o,e,r,n)},i.prototype.applyGetters=function(t,e){if(i._isRef(this,t,e,!0))return t;var r=t,n=this.getters,o=n.length;if(!o)return r;for(;o--;)r=n[o].call(e,r,this);return r},i.prototype.select=function(t){return this.selected=!!t,this},i.prototype.doValidate=function(t,e,r){var n=!1,i=this.path,s=this.validators.length;if(!s)return e(null);var a=function(t,r){n||(void 0===t||t?--s||e(null):(n=new f(r),e(n)))},u=this;this.validators.forEach(function(e){var n=e.validator,s=(e.message,e.type,o.clone(e));if(s.path=i,s.value=t,n instanceof RegExp)a(n.test(t),s);else if("function"==typeof n){if(void 0===t&&!u.isRequired)return void a(!0,s);2===n.length?n.call(r,t,function(t){a(t,s)}):a(n.call(r,t),s)}})},i.prototype.doValidateSync=function(t,e){var r=null,n=this.path,i=this.validators.length;if(!i)return null;var s=function(t,e){r||void 0===t||t||(r=new f(e))},a=this;return void 0!==t||a.isRequired?(this.validators.forEach(function(r){var i=r.validator,a=o.clone(r);a.path=n,a.value=t,i instanceof RegExp?s(i.test(t),a):"function"==typeof i&&2!==i.length&&s(i.call(e,t),a)}),r):null},i._isRef=function(t,e,r,i){var s=i&&t.options&&t.options.ref;if(!s&&r&&r.$__fullPath){var a=r.$__fullPath(t.path),u=r.ownerDocument?r.ownerDocument():r;s=u.populated(a)}if(s){if(null==e)return!0;if(!n.isBuffer(e)&&"Binary"!=e._bsontype&&o.isObject(e))return!0}return!1},e.exports=r=i,r.CastError=u,r.ValidatorError=f}).call(this,t("buffer").Buffer)},{"./error":8,"./utils":38,buffer:40}],31:[function(t,e,r){var n=t("./utils"),i=e.exports=r=function(){this.paths={},this.states={}};i.ctor=function(){var t=n.args(arguments),e=function(){i.apply(this,arguments),this.stateNames=t;for(var e,r=t.length;r--;)e=t[r],this.states[e]={}};return e.prototype=new i,t.forEach(function(t){e.prototype[t]=function(e){this._changeState(e,t)}}),e},i.prototype._changeState=function(t,e){var r=this.states[this.paths[t]];r&&delete r[t],this.paths[t]=e,this.states[e][t]=!0},i.prototype.clear=function(t){for(var e,r=Object.keys(this.states[t]),n=r.length;n--;)e=r[n],delete this.states[t][e],delete this.paths[e]},i.prototype.some=function(){var t=this,e=arguments.length?arguments:this.stateNames;return Array.prototype.some.call(e,function(e){return Object.keys(t.states[e]).length})},i.prototype._iter=function(t){return function(){var e=arguments.length,r=n.args(arguments,0,e-1),i=arguments[e-1];r.length||(r=this.stateNames);var o=this,s=r.reduce(function(t,e){return t.concat(Object.keys(o.states[e]))},[]);return s[t](function(t,e,r){return i(t,e,r)})}},i.prototype.forEach=function(){return this.forEach=this._iter("forEach"),this.forEach.apply(this,arguments)},i.prototype.map=function(){return this.map=this._iter("map"),this.map.apply(this,arguments)}},{"./utils":38}],32:[function(t,e,r){(function(n){function i(t,e,r){var n=[];return n.push.apply(n,t),u.decorate(n,i.mixin),n.isMongooseArray=!0,n._atomics={},n.validators=[],n._path=e,r&&(n._parent=r,n._schema=r.schema.path(e)),n}var o=t("./embedded"),s=t("../document"),a=t("./objectid"),u=t("../utils"),f=u.isMongooseObject;i.mixin={_atomics:void 0,_parent:void 0,_cast:function(t){var e,r=this._owner,i=!1;if(this._parent&&(r||(r=this._owner=this._parent.ownerDocument?this._parent.ownerDocument():this._parent),i=r.populated(this._path,!0)),i&&null!=t){e=i.options.model,(n.isBuffer(t)||t instanceof a||!u.isObject(t))&&(t={_id:t});var o=t.schema&&t.schema.discriminatorMapping&&void 0!==t.schema.discriminatorMapping.key;return o||(t=new e(t)),this._schema.caster.cast(t,this._parent,!0)}return this._schema.caster.cast(t,this._parent,!1)},_markModified:function(t,e){var r,n=this._parent;return n&&(r=this._path,arguments.length&&(r=null!=e?r+"."+this.indexOf(t)+"."+e:r+"."+t),n.markModified(r)),this},_registerAtomic:function(t,e){if("$set"==t)return this._atomics={$set:e},this;var r=this._atomics;if("$pop"==t&&!("$pop"in r)){var n=this;this._parent.once("save",function(){n._popped=n._shifted=null})}if(this._atomics.$set||Object.keys(r).length&&!(t in r))return this._atomics={$set:this},this;if("$pullAll"===t||"$pushAll"===t||"$addToSet"===t)r[t]||(r[t]=[]),r[t]=r[t].concat(e);else if("$pullDocs"===t){var i=r.$pull||(r.$pull={}),o=i._id||(i._id={$in:[]});o.$in=o.$in.concat(e)}else r[t]=e;return this},$__getAtomics:function(){var t=[],e=Object.keys(this._atomics),r=e.length;if(0===r)return t[0]=["$set",this.toObject({depopulate:1})],t;for(;r--;){var n=e[r],i=this._atomics[n];f(i)?i=i.toObject({depopulate:1}):Array.isArray(i)?i=this.toObject.call(i,{depopulate:1}):i.valueOf&&(i=i.valueOf()),"$addToSet"==n&&(i={$each:i}),t.push([n,i])}return t},hasAtomics:function(){return this._atomics&&"Object"===this._atomics.constructor.name?Object.keys(this._atomics).length:0},push:function(){var t=[].map.call(arguments,this._cast,this),e=[].push.apply(this,t);return this._registerAtomic("$pushAll",t),this._markModified(),e},nonAtomicPush:function(){var t=[].map.call(arguments,this._cast,this),e=[].push.apply(this,t);return this._registerAtomic("$set",this),this._markModified(),e},$pop:function(){return this._registerAtomic("$pop",1),this._markModified(),this._popped?void 0:(this._popped=!0,[].pop.call(this))},pop:function(){var t=[].pop.call(this);return this._registerAtomic("$set",this),this._markModified(),t},$shift:function(){return this._registerAtomic("$pop",-1),this._markModified(),this._shifted?void 0:(this._shifted=!0,[].shift.call(this))},shift:function(){var t=[].shift.call(this);return this._registerAtomic("$set",this),this._markModified(),t},pull:function(){for(var t,e=[].map.call(arguments,this._cast,this),r=this._parent.get(this._path),n=r.length;n--;)t=r[n],t instanceof o?e.some(function(e){return e.equals(t)})&&[].splice.call(r,n,1):~r.indexOf.call(e,t)&&[].splice.call(r,n,1);return e[0]instanceof o?this._registerAtomic("$pullDocs",e.map(function(t){return t._id})):this._registerAtomic("$pullAll",e),this._markModified(),this},splice:function(){var t,e,r;if(arguments.length){for(e=[],r=0;r<arguments.length;++r)e[r]=2>r?arguments[r]:this._cast(arguments[r]);t=[].splice.apply(this,e),this._registerAtomic("$set",this),this._markModified()}return t},unshift:function(){var t=[].map.call(arguments,this._cast,this);return[].unshift.apply(this,t),this._registerAtomic("$set",this),this._markModified(),this.length},sort:function(){var t=[].sort.apply(this,arguments);return this._registerAtomic("$set",this),this._markModified(),t},addToSet:function(){var t=[].map.call(arguments,this._cast,this),e=[],r=t[0]instanceof o?"doc":t[0]instanceof Date?"date":"";return t.forEach(function(t){var n;switch(r){case"doc":n=this.some(function(e){return e.equals(t)});break;case"date":var i=+t;n=this.some(function(t){return+t===i});break;default:n=~this.indexOf(t)}n||([].push.call(this,t),this._registerAtomic("$addToSet",t),this._markModified(),[].push.call(e,t))},this),e},set:function(t,e){return this[t]=this._cast(e),this._markModified(t),this},toObject:function(t){return t&&t.depopulate?this.map(function(e){return e instanceof s?e.toObject(t):e}):this.slice()},inspect:function(){return JSON.stringify(this)},indexOf:function(t){t instanceof a&&(t=t.toString());for(var e=0,r=this.length;r>e;++e)if(t==this[e])return e;return-1}},i.mixin.remove=i.mixin.pull,e.exports=r=i}).call(this,t("buffer").Buffer)},{"../document":4,"../utils":38,"./embedded":35,"./objectid":37,buffer:40}],33:[function(t,e){(function(r,n){function i(t,e,r){var o,a=arguments.length;o=0===a||null===arguments[0]||void 0===arguments[0]?0:t;var u,f,c;Array.isArray(e)?(f=e[0],c=e[1]):u=e;var h=new n(o,u,r);return s.decorate(h,i.mixin),h.isMongooseBuffer=!0,Object.defineProperties(h,{validators:{value:[]},_path:{value:f},_parent:{value:c}}),c&&"string"==typeof f&&Object.defineProperty(h,"_schema",{value:c.schema.path(f)}),h._subtype=0,h}var o=(r.MONGOOSE_DRIVER_PATH||"../drivers/node-mongodb-native",t("../drivers/node-mongodb-native/binary")),s=t("../utils");i.mixin={_parent:void 0,_subtype:void 0,_markModified:function(){var t=this._parent;return t&&t.markModified(this._path),this},write:function(){var t=n.prototype.write.apply(this,arguments);return t>0&&this._markModified(),t},copy:function(t){var e=n.prototype.copy.apply(this,arguments);return t&&t.isMongooseBuffer&&t._markModified(),e
}},"writeUInt8 writeUInt16 writeUInt32 writeInt8 writeInt16 writeInt32 writeFloat writeDouble fill utf8Write binaryWrite asciiWrite set writeUInt16LE writeUInt16BE writeUInt32LE writeUInt32BE writeInt16LE writeInt16BE writeInt32LE writeInt32BE writeFloatLE writeFloatBE writeDoubleLE writeDoubleBE".split(" ").forEach(function(t){n.prototype[t]&&(i.mixin[t]=new Function("var ret = Buffer.prototype."+t+".apply(this, arguments);this._markModified();return ret;"))}),i.mixin.toObject=function(t){var e="number"==typeof t?t:this._subtype||0;return new o(this,e)},i.mixin.equals=function(t){if(!n.isBuffer(t))return!1;if(this.length!==t.length)return!1;for(var e=0;e<this.length;++e)if(this[e]!==t[e])return!1;return!0},i.mixin.subtype=function(t){if("number"!=typeof t)throw new TypeError("Invalid subtype. Expected a number");this._subtype!=t&&this._markModified(),this._subtype=t},i.Binary=o,e.exports=i}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},t("buffer").Buffer)},{"../drivers/node-mongodb-native/binary":6,"../utils":38,buffer:40}],34:[function(t,e){(function(r){function n(t,e,r){var i=[];return i.push.apply(i,t),a.decorate(i,n.mixin),i.isMongooseArray=!0,i.isMongooseDocumentArray=!0,i._atomics={},i.validators=[],i._path=e,r&&(i._parent=r,i._schema=r.schema.path(e),i._handlers={isNew:i.notify("isNew"),save:i.notify("save")},r.on("save",i._handlers.save),r.on("isNew",i._handlers.isNew)),i}var i=t("./array"),o=t("./objectid"),s=t("../schema/objectid"),a=t("../utils"),u=t("util"),f=t("../document");n.mixin=Object.create(i.mixin),n.mixin._cast=function(t){return t instanceof this._schema.casterConstructor?(t.__parent&&t.__parentArray||(t.__parent=this._parent,t.__parentArray=this),t):((r.isBuffer(t)||t instanceof o||!a.isObject(t))&&(t={_id:t}),new this._schema.casterConstructor(t,this))},n.mixin.id=function(t){var e,r,n;try{var i=s.prototype.cast.call({},t);i&&(e=String(i))}catch(t){e=null}for(var a=0,u=this.length;u>a;a++)if(n=this[a].get("_id"),n instanceof f){if(r||(r=String(t)),r==n._id)return this[a]}else if(n instanceof o){if(e==n)return this[a]}else if(r||(r=String(t)),r==n)return this[a];return null},n.mixin.toObject=function(t){return this.map(function(e){return e&&e.toObject(t)||null})},n.mixin.inspect=function(){return"["+this.map(function(t){return t?t.inspect?t.inspect():u.inspect(t):"null"}).join("\n")+"]"},n.mixin.create=function(t){return new this._schema.casterConstructor(t)},n.mixin.notify=function(t){var e=this;return function(r){for(var n=e.length;n--;)if(e[n]){switch(t){case"save":r=e[n]}e[n].emit(t,r)}}},e.exports=n}).call(this,t("buffer").Buffer)},{"../document":4,"../schema/objectid":28,"../utils":38,"./array":32,"./objectid":37,buffer:40,util:48}],35:[function(t,e){function r(t,e,r,n){e?(this.__parentArray=e,this.__parent=e._parent):(this.__parentArray=void 0,this.__parent=void 0),i.call(this,t,n,r);var o=this;this.on("isNew",function(t){o.isNew=t})}function n(t){function e(){r.removeListener("save",e),r.removeListener("remove",e),t.emit("remove",t),r=t=e=null}var r=t.ownerDocument();r.on("save",e),r.on("remove",e)}var i=t("../document_provider")(),o=t("util").inspect,s=t("../promise");r.prototype=Object.create(i.prototype),r.prototype.constructor=r,r.prototype.markModified=function(t){this.__parentArray&&(this.$__.activePaths.modify(t),this.isNew?this.__parentArray._markModified():this.__parentArray._markModified(this,t))},r.prototype.save=function(t){var e=new s(t);return e.fulfill(),e},r.prototype.remove=function(t){if(!this.__parentArray)return this;var e;if(!this.willRemove){if(e=this._doc._id,!e)throw new Error("For your own good, Mongoose does not know how to remove an EmbeddedDocument that has no _id");this.__parentArray.pull({_id:e}),this.willRemove=!0,n(this)}return t&&t(null),this},r.prototype.update=function(){throw new Error("The #update method is not available on EmbeddedDocuments")},r.prototype.inspect=function(){return o(this.toObject())},r.prototype.invalidate=function(t,e,r,n){if(!this.__parent){var i="Unable to invalidate a subdocument that has not been added to an array.";throw new Error(i)}var o=this.__parentArray.indexOf(this),s=this.__parentArray._path,a=[s,o,t].join(".");return 2<arguments.length?this.__parent.invalidate(a,e,r):this.__parent.invalidate(a,e),n&&(this.$__.validationError=this.ownerDocument().$__.validationError),!0},r.prototype.ownerDocument=function(){if(this.$__.ownerDocument)return this.$__.ownerDocument;var t=this.__parent;if(!t)return this;for(;t.__parent;)t=t.__parent;return this.$__.ownerDocument=t},r.prototype.$__fullPath=function(t){if(!this.$__.fullPath){var e=this;if(!e.__parent)return t;for(var r=[];e.__parent;)r.unshift(e.__parentArray._path),e=e.__parent;this.$__.fullPath=r.join("."),this.$__.ownerDocument||(this.$__.ownerDocument=e)}return t?this.$__.fullPath+"."+t:this.$__.fullPath},r.prototype.parent=function(){return this.__parent},r.prototype.parentArray=function(){return this.__parentArray},e.exports=r},{"../document_provider":5,"../promise":18,util:48}],36:[function(t,e,r){r.Array=t("./array"),r.Buffer=t("./buffer"),r.Document=r.Embedded=t("./embedded"),r.DocumentArray=t("./documentarray"),r.ObjectId=t("./objectid")},{"./array":32,"./buffer":33,"./documentarray":34,"./embedded":35,"./objectid":37}],37:[function(t,e){(function(r){var n=(r.MONGOOSE_DRIVER_PATH||"../drivers/node-mongodb-native",t("../drivers/node-mongodb-native/objectid"));e.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../drivers/node-mongodb-native/objectid":7}],38:[function(t,e,r){(function(e,n){function i(t){var e;return!~m.indexOf(t.toLowerCase())&&(e=_.filter(function(e){return t.match(e[0])}),e[0])?t.replace(e[0][0],e[0][1]):t}function o(t,e){var r,n,i,o,s,a=e&&e.retainKeyOrder,u=e&&e.minimize,f={};if(a)for(o in t)i=v(t[o],e),u&&"undefined"==typeof i||(r||(r=!0),f[o]=i);else for(n=Object.keys(t),s=n.length;s--;)o=n[s],i=v(t[o],e),u&&"undefined"==typeof i||(r||(r=!0),f[o]=i);return u?r&&f:f}function s(t,e){for(var r=[],n=0,i=t.length;i>n;n++)r.push(v(t[n],e));return r}function a(t,e,r,n,i){this.path=t,this.match=r,this.select=e,this.options=n,this.model=i,this._docs={}}var u,f,c,h=t("mongodb/lib/mongodb/connection/read_preference").ReadPreference,p=t("./types/objectid"),l=t("regexp-clone"),d=t("sliced"),y=t("mpath"),g=t("ms");r.toCollectionName=function(t,e){return e=e||{},"system.profile"===t?t:"system.indexes"===t?t:e.pluralization===!1?t:i(t.toLowerCase())},r.pluralization=[[/(m)an$/gi,"$1en"],[/(pe)rson$/gi,"$1ople"],[/(child)$/gi,"$1ren"],[/^(ox)$/gi,"$1en"],[/(ax|test)is$/gi,"$1es"],[/(octop|vir)us$/gi,"$1i"],[/(alias|status)$/gi,"$1es"],[/(bu)s$/gi,"$1ses"],[/(buffal|tomat|potat)o$/gi,"$1oes"],[/([ti])um$/gi,"$1a"],[/sis$/gi,"ses"],[/(?:([^f])fe|([lr])f)$/gi,"$1$2ves"],[/(hive)$/gi,"$1s"],[/([^aeiouy]|qu)y$/gi,"$1ies"],[/(x|ch|ss|sh)$/gi,"$1es"],[/(matr|vert|ind)ix|ex$/gi,"$1ices"],[/([m|l])ouse$/gi,"$1ice"],[/(kn|w|l)ife$/gi,"$1ives"],[/(quiz)$/gi,"$1zes"],[/s$/gi,"s"],[/([^a-z])$/,"$1"],[/$/gi,"s"]];var _=r.pluralization;r.uncountables=["advice","energy","excretion","digestion","cooperation","health","justice","labour","machinery","equipment","information","pollution","sewage","paper","money","species","series","rain","rice","fish","sheep","moose","deer","news","expertise","status","media"];var m=r.uncountables;r.deepEqual=function t(e,i){if(e===i)return!0;if(e instanceof Date&&i instanceof Date)return e.getTime()===i.getTime();if(e instanceof p&&i instanceof p)return e.toString()===i.toString();if(e instanceof RegExp&&i instanceof RegExp)return e.source==i.source&&e.ignoreCase==i.ignoreCase&&e.multiline==i.multiline&&e.global==i.global;if("object"!=typeof e&&"object"!=typeof i)return e==i;if(null===e||null===i||void 0===e||void 0===i)return!1;if(e.prototype!==i.prototype)return!1;if(e instanceof Number&&i instanceof Number)return e.valueOf()===i.valueOf();if(n.isBuffer(e))return r.buffer.areEqual(e,i);w(e)&&(e=e.toObject()),w(i)&&(i=i.toObject());try{var o,s,a=Object.keys(e),u=Object.keys(i)}catch(t){return!1}if(a.length!=u.length)return!1;for(a.sort(),u.sort(),s=a.length-1;s>=0;s--)if(a[s]!=u[s])return!1;for(s=a.length-1;s>=0;s--)if(o=a[s],!t(e[o],i[o]))return!1;return!0},r.clone=function(t,e){if(void 0===t||null===t)return t;if(Array.isArray(t))return s(t,e);if(w(t))return e&&e.json&&"function"==typeof t.toJSON?t.toJSON(e):t.toObject(e);if(t.constructor)switch(r.getFunctionName(t.constructor)){case"Object":return o(t,e);case"Date":return new t.constructor(+t);case"RegExp":return l(t)}return t instanceof p?new p(t.id):!t.constructor&&r.isObject(t)?o(t,e):t.valueOf?t.valueOf():void 0};var v=r.clone;r.options=function(t,e){var r,n=Object.keys(t),i=n.length;for(e=e||{};i--;)r=n[i],r in e||(e[r]=t[r]);return e},r.random=function(){return Math.random().toString().substr(3)},r.merge=function t(e,n){for(var i,o=Object.keys(n),s=o.length;s--;)i=o[s],"undefined"==typeof e[i]?e[i]=n[i]:r.isObject(n[i])&&t(e[i],n[i])};var b=Object.prototype.toString;r.isObject=function(t){return"[object Object]"==b.call(t)},r.args=d,r.tick=function(t){return"function"==typeof t?function(){try{t.apply(this,arguments)}catch(t){e.nextTick(function(){throw t})}}:void 0},r.isMongooseObject=function(e){return c||(c=t("./document")),f||(f=t("./types").Array),u||(u=t("./types").Buffer),e instanceof c||e&&e.isMongooseArray||e&&e.isMongooseBuffer};var w=r.isMongooseObject;r.expires=function(t){if(t&&"Object"==t.constructor.name&&"expires"in t){var e;e="string"!=typeof t.expires?t.expires:Math.round(g(t.expires)/1e3),t.expireAfterSeconds=e,delete t.expires}},r.readPref=function(t,e){if(Array.isArray(t)&&(e=t[1],t=t[0]),t instanceof h)return t;switch(t){case"p":t="primary";break;case"pp":t="primaryPreferred";break;case"s":t="secondary";break;case"sp":t="secondaryPreferred";break;case"n":t="nearest"}return new h(t,e)},a.prototype.constructor=Object,r.PopulateOptions=a,r.populate=function(t,e,n,i,o){if(1===arguments.length){if(t instanceof a)return[t];if(Array.isArray(t))return t.map(function(t){return r.populate(t)[0]});r.isObject(t)&&(i=t.match,o=t.options,e=t.select,n=t.model,t=t.path)}else"string"!=typeof n&&"function"!=typeof n&&(o=i,i=n,n=void 0);if("string"!=typeof t)throw new TypeError("utils.populate: invalid path. Expected string. Got typeof `"+typeof t+"`");for(var s=[],u=t.split(" "),f=0;f<u.length;++f)s.push(new a(u[f],e,i,o,n));return s},r.getValue=function(t,e,r){return y.get(t,e,"_doc",r)},r.setValue=function(t,e,r,n){y.set(t,e,r,"_doc",n)},r.object={},r.object.vals=function(t){for(var e=Object.keys(t),r=e.length,n=[];r--;)n.push(t[e[r]]);return n},r.object.shallowCopy=r.options;var O=Object.prototype.hasOwnProperty;r.object.hasOwnProperty=function(t,e){return O.call(t,e)},r.isNullOrUndefined=function(t){return null==t},r.array={},r.array.flatten=function t(e,r,n){return n||(n=[]),e.forEach(function(e){Array.isArray(e)?t(e,r,n):(!r||r(e))&&n.push(e)}),n},r.buffer={},r.buffer.areEqual=function(t,e){if(!n.isBuffer(t))return!1;if(!n.isBuffer(e))return!1;if(t.length!==e.length)return!1;for(var r=0,i=t.length;i>r;++r)if(t[r]!==e[r])return!1;return!0},r.getFunctionName=function(t){return t.name?t.name:(t.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1]},r.decorate=function(t,e){for(var r in e)t[r]=e[r]},r.mergeClone=function(t,e){for(var n,i=Object.keys(e),o=i.length;o--;)n=i[o],"undefined"==typeof t[n]?t[n]=r.clone(e[n],{retainKeyOrder:1}):r.isObject(e[n])?r.mergeClone(t[n],e[n]):t[n]=r.clone(e[n],{retainKeyOrder:1})},r.each=function(t,e){for(var r=0;r<t.length;++r)e(t[r])}}).call(this,t("FWaASH"),t("buffer").Buffer)},{"./document":4,"./types":36,"./types/objectid":37,FWaASH:46,buffer:40,"mongodb/lib/mongodb/connection/read_preference":51,mpath:65,ms:68,"regexp-clone":69,sliced:70}],39:[function(t,e){function r(t,e){this.path=e,this.getters=[],this.setters=[],this.options=t||{}}r.prototype.get=function(t){return this.getters.push(t),this},r.prototype.set=function(t){return this.setters.push(t),this},r.prototype.applyGetters=function(t,e){for(var r=t,n=this.getters.length-1;n>=0;n--)r=this.getters[n].call(e,r,this);return r},r.prototype.applySetters=function(t,e){for(var r=t,n=this.setters.length-1;n>=0;n--)r=this.setters[n].call(e,r,this);return r},e.exports=r},{}],40:[function(t,e,r){function n(t,e,r){if(!(this instanceof n))return new n(t,e,r);var i,o=typeof t;if("number"===o)i=t>0?t>>>0:0;else if("string"===o)"base64"===e&&(t=B(t)),i=n.byteLength(t,e);else{if("object"!==o||null===t)throw new TypeError("must start with number, buffer, array or string");"Buffer"===t.type&&M(t.data)&&(t=t.data),i=+t.length>0?Math.floor(+t.length):0}if(this.length>L)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+L.toString(16)+" bytes");var s;n.TYPED_ARRAY_SUPPORT?s=n._augment(new Uint8Array(i)):(s=this,s.length=i,s._isBuffer=!0);var a;if(n.TYPED_ARRAY_SUPPORT&&"number"==typeof t.byteLength)s._set(t);else if(E(t))if(n.isBuffer(t))for(a=0;i>a;a++)s[a]=t.readUInt8(a);else for(a=0;i>a;a++)s[a]=(t[a]%256+256)%256;else if("string"===o)s.write(t,0,e);else if("number"===o&&!n.TYPED_ARRAY_SUPPORT&&!r)for(a=0;i>a;a++)s[a]=0;return s}function i(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;n>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[r+s]=a}return s}function o(t,e,r,n){var i=j(N(e),t,r,n);return i}function s(t,e,r,n){var i=j(T(e),t,r,n);return i}function a(t,e,r,n){return s(t,e,r,n)}function u(t,e,r,n){var i=j(x(e),t,r,n);return i}function f(t,e,r,n){var i=j($(e),t,r,n,2);return i}function c(t,e,r){return I.fromByteArray(0===e&&r===t.length?t:t.slice(e,r))}function h(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var o=e;r>o;o++)t[o]<=127?(n+=D(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return n+D(i)}function p(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function l(t,e,r){return p(t,e,r)}function d(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",o=e;r>o;o++)i+=S(t[o]);return i}function y(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function g(t,e,r){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function _(t,e,r,i,o,s){if(!n.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||s>e)throw new TypeError("value is out of bounds");if(r+i>t.length)throw new TypeError("index out of range")}function m(t,e,r,n){0>e&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);o>i;i++)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function v(t,e,r,n){0>e&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);o>i;i++)t[r+i]=e>>>8*(n?i:3-i)&255}function b(t,e,r,n,i,o){if(e>i||o>e)throw new TypeError("value is out of bounds");if(r+n>t.length)throw new TypeError("index out of range")}function w(t,e,r,n,i){return i||b(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),R.write(t,e,r,n,23,4),r+4}function O(t,e,r,n,i){return i||b(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),R.write(t,e,r,n,52,8),r+8}function B(t){for(t=A(t).replace(k,"");t.length%4!==0;)t+="=";return t}function A(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function E(t){return M(t)||n.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function S(t){return 16>t?"0"+t.toString(16):t.toString(16)}function N(t){for(var e=[],r=0;r<t.length;r++){var n=t.charCodeAt(r);if(127>=n)e.push(n);else{var i=r;n>=55296&&57343>=n&&r++;for(var o=encodeURIComponent(t.slice(i,r+1)).substr(1).split("%"),s=0;s<o.length;s++)e.push(parseInt(o[s],16))}}return e}function T(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function $(t){for(var e,r,n,i=[],o=0;o<t.length;o++)e=t.charCodeAt(o),r=e>>8,n=e%256,i.push(n),i.push(r);return i}function x(t){return I.toByteArray(t)}function j(t,e,r,n,i){i&&(n-=n%i);for(var o=0;n>o&&!(o+r>=e.length||o>=t.length);o++)e[o+r]=t[o];return o}function D(t){try{return decodeURIComponent(t)}catch(t){return String.fromCharCode(65533)}}var I=t("base64-js"),R=t("ieee754"),M=t("is-array");r.Buffer=n,r.SlowBuffer=n,r.INSPECT_MAX_BYTES=50,n.poolSize=8192;var L=1073741823;n.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(t){return!1}}(),n.isBuffer=function(t){return!(null==t||!t._isBuffer)},n.compare=function(t,e){if(!n.isBuffer(t)||!n.isBuffer(e))throw new TypeError("Arguments must be Buffers");for(var r=t.length,i=e.length,o=0,s=Math.min(r,i);s>o&&t[o]===e[o];o++);return o!==s&&(r=t[o],i=e[o]),i>r?-1:r>i?1:0},n.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(t,e){if(!M(t))throw new TypeError("Usage: Buffer.concat(list[, length])");if(0===t.length)return new n(0);if(1===t.length)return t[0];var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var i=new n(e),o=0;for(r=0;r<t.length;r++){var s=t[r];s.copy(i,o),o+=s.length}return i},n.byteLength=function(t,e){var r;switch(t+="",e||"utf8"){case"ascii":case"binary":case"raw":r=t.length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":r=2*t.length;break;case"hex":r=t.length>>>1;break;case"utf8":case"utf-8":r=N(t).length;break;case"base64":r=x(t).length;break;default:r=t.length}return r},n.prototype.length=void 0,n.prototype.parent=void 0,n.prototype.toString=function(t,e,r){var n=!1;if(e>>>=0,r=void 0===r||1/0===r?this.length:r>>>0,t||(t="utf8"),0>e&&(e=0),r>this.length&&(r=this.length),e>=r)return"";for(;;)switch(t){case"hex":return d(this,e,r);case"utf8":case"utf-8":return h(this,e,r);case"ascii":return p(this,e,r);case"binary":return l(this,e,r);case"base64":return c(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}},n.prototype.equals=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return 0===n.compare(this,t)},n.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},n.prototype.compare=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return n.compare(this,t)},n.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},n.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},n.prototype.write=function(t,e,r,n){if(isFinite(e))isFinite(r)||(n=r,r=void 0);else{var c=n;n=e,e=r,r=c}e=Number(e)||0;var h=this.length-e;r?(r=Number(r),r>h&&(r=h)):r=h,n=String(n||"utf8").toLowerCase();var p;switch(n){case"hex":p=i(this,t,e,r);break;case"utf8":case"utf-8":p=o(this,t,e,r);break;case"ascii":p=s(this,t,e,r);break;case"binary":p=a(this,t,e,r);break;case"base64":p=u(this,t,e,r);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":p=f(this,t,e,r);break;default:throw new TypeError("Unknown encoding: "+n)}return p},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},n.prototype.slice=function(t,e){var r=this.length;if(t=~~t,e=void 0===e?r:~~e,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),t>e&&(e=t),n.TYPED_ARRAY_SUPPORT)return n._augment(this.subarray(t,e));for(var i=e-t,o=new n(i,void 0,!0),s=0;i>s;s++)o[s]=this[s+t];return o},n.prototype.readUInt8=function(t,e){return e||g(t,1,this.length),this[t]},n.prototype.readUInt16LE=function(t,e){return e||g(t,2,this.length),this[t]|this[t+1]<<8},n.prototype.readUInt16BE=function(t,e){return e||g(t,2,this.length),this[t]<<8|this[t+1]},n.prototype.readUInt32LE=function(t,e){return e||g(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},n.prototype.readUInt32BE=function(t,e){return e||g(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},n.prototype.readInt8=function(t,e){return e||g(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},n.prototype.readInt16LE=function(t,e){e||g(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt16BE=function(t,e){e||g(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt32LE=function(t,e){return e||g(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},n.prototype.readInt32BE=function(t,e){return e||g(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},n.prototype.readFloatLE=function(t,e){return e||g(t,4,this.length),R.read(this,t,!0,23,4)},n.prototype.readFloatBE=function(t,e){return e||g(t,4,this.length),R.read(this,t,!1,23,4)},n.prototype.readDoubleLE=function(t,e){return e||g(t,8,this.length),R.read(this,t,!0,52,8)},n.prototype.readDoubleBE=function(t,e){return e||g(t,8,this.length),R.read(this,t,!1,52,8)},n.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,1,255,0),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},n.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):m(this,t,e,!0),e+2},n.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):m(this,t,e,!1),e+2},n.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):v(this,t,e,!0),e+4},n.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):v(this,t,e,!1),e+4},n.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,1,127,-128),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},n.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):m(this,t,e,!0),e+2},n.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):m(this,t,e,!1),e+2},n.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,4,2147483647,-2147483648),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):v(this,t,e,!0),e+4},n.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||_(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):v(this,t,e,!1),e+4},n.prototype.writeFloatLE=function(t,e,r){return w(this,t,e,!0,r)},n.prototype.writeFloatBE=function(t,e,r){return w(this,t,e,!1,r)},n.prototype.writeDoubleLE=function(t,e,r){return O(this,t,e,!0,r)},n.prototype.writeDoubleBE=function(t,e,r){return O(this,t,e,!1,r)},n.prototype.copy=function(t,e,r,i){var o=this;if(r||(r=0),i||0===i||(i=this.length),e||(e=0),i!==r&&0!==t.length&&0!==o.length){if(r>i)throw new TypeError("sourceEnd < sourceStart");if(0>e||e>=t.length)throw new TypeError("targetStart out of bounds");if(0>r||r>=o.length)throw new TypeError("sourceStart out of bounds");if(0>i||i>o.length)throw new TypeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var s=i-r;if(1e3>s||!n.TYPED_ARRAY_SUPPORT)for(var a=0;s>a;a++)t[a+e]=this[a+r];else t._set(this.subarray(r,r+s),e)}},n.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),e>r)throw new TypeError("end < start");if(r!==e&&0!==this.length){if(0>e||e>=this.length)throw new TypeError("start out of bounds");if(0>r||r>this.length)throw new TypeError("end out of bounds");var n;if("number"==typeof t)for(n=e;r>n;n++)this[n]=t;else{var i=N(t.toString()),o=i.length;for(n=e;r>n;n++)this[n]=i[n%o]}return this}},n.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(n.TYPED_ARRAY_SUPPORT)return new n(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var P=n.prototype;n._augment=function(t){return t.constructor=n,t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=P.get,t.set=P.set,t.write=P.write,t.toString=P.toString,t.toLocaleString=P.toString,t.toJSON=P.toJSON,t.equals=P.equals,t.compare=P.compare,t.copy=P.copy,t.slice=P.slice,t.readUInt8=P.readUInt8,t.readUInt16LE=P.readUInt16LE,t.readUInt16BE=P.readUInt16BE,t.readUInt32LE=P.readUInt32LE,t.readUInt32BE=P.readUInt32BE,t.readInt8=P.readInt8,t.readInt16LE=P.readInt16LE,t.readInt16BE=P.readInt16BE,t.readInt32LE=P.readInt32LE,t.readInt32BE=P.readInt32BE,t.readFloatLE=P.readFloatLE,t.readFloatBE=P.readFloatBE,t.readDoubleLE=P.readDoubleLE,t.readDoubleBE=P.readDoubleBE,t.writeUInt8=P.writeUInt8,t.writeUInt16LE=P.writeUInt16LE,t.writeUInt16BE=P.writeUInt16BE,t.writeUInt32LE=P.writeUInt32LE,t.writeUInt32BE=P.writeUInt32BE,t.writeInt8=P.writeInt8,t.writeInt16LE=P.writeInt16LE,t.writeInt16BE=P.writeInt16BE,t.writeInt32LE=P.writeInt32LE,t.writeInt32BE=P.writeInt32BE,t.writeFloatLE=P.writeFloatLE,t.writeFloatBE=P.writeFloatBE,t.writeDoubleLE=P.writeDoubleLE,t.writeDoubleBE=P.writeDoubleBE,t.fill=P.fill,t.inspect=P.inspect,t.toArrayBuffer=P.toArrayBuffer,t};var k=/[^+\/0-9A-z]/g},{"base64-js":41,ieee754:42,"is-array":43}],41:[function(t,e,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s?62:e===a?63:u>e?-1:u+10>e?e-u+26+26:c+26>e?e-c:f+26>e?e-f+26:void 0}function r(t){function r(t){f[h++]=t}var n,i,s,a,u,f;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=t.length;u="="===t.charAt(c-2)?2:"="===t.charAt(c-1)?1:0,f=new o(3*t.length/4-u),s=u>0?t.length-4:t.length;var h=0;for(n=0,i=0;s>n;n+=4,i+=3)a=e(t.charAt(n))<<18|e(t.charAt(n+1))<<12|e(t.charAt(n+2))<<6|e(t.charAt(n+3)),r((16711680&a)>>16),r((65280&a)>>8),r(255&a);return 2===u?(a=e(t.charAt(n))<<2|e(t.charAt(n+1))>>4,r(255&a)):1===u&&(a=e(t.charAt(n))<<10|e(t.charAt(n+1))<<4|e(t.charAt(n+2))>>2,r(a>>8&255),r(255&a)),f}function i(t){function e(t){return n.charAt(t)}function r(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,s,a=t.length%3,u="";for(i=0,s=t.length-a;s>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=r(o);switch(a){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),u="0".charCodeAt(0),f="a".charCodeAt(0),c="A".charCodeAt(0);t.toByteArray=r,t.fromByteArray=i}("undefined"==typeof r?this.base64js={}:r)},{}],42:[function(t,e,r){r.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,f=u>>1,c=-7,h=r?i-1:0,p=r?-1:1,l=t[e+h];for(h+=p,o=l&(1<<-c)-1,l>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=p,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=256*s+t[e+h],h+=p,c-=8);if(0===o)o=1-f;else{if(o===u)return s?0/0:1/0*(l?-1:1);s+=Math.pow(2,n),o-=f}return(l?-1:1)*s*Math.pow(2,o-n)},r.write=function(t,e,r,n,i,o){var s,a,u,f=8*o-i-1,c=(1<<f)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,l=n?0:o-1,d=n?1:-1,y=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+h>=1?p/u:p*Math.pow(2,1-h),e*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[r+l]=255&a,l+=d,a/=256,i-=8);for(s=s<<i|a,f+=i;f>0;t[r+l]=255&s,l+=d,s/=256,f-=8);t[r+l-d]|=128*y}},{}],43:[function(t,e){var r=Array.isArray,n=Object.prototype.toString;e.exports=r||function(t){return!!t&&"[object Array]"==n.call(t)}},{}],44:[function(t,e){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(t){return"function"==typeof t}function i(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!i(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,r,i,a,u,f;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[t],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,a=new Array(i-1),u=1;i>u;u++)a[u-1]=arguments[u];r.apply(this,a)}else if(o(r)){for(i=arguments.length,a=new Array(i-1),u=1;i>u;u++)a[u-1]=arguments[u];for(f=r.slice(),i=f.length,u=0;i>u;u++)f[u].apply(this,a)}return!0},r.prototype.addListener=function(t,e){var i;if(!n(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,n(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned){var i;i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,i&&i>0&&this._events[t].length>i&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function r(){this.removeListener(t,r),i||(i=!0,e.apply(this,arguments))}if(!n(e))throw TypeError("listener must be a function");var i=!1;return r.listener=e,this.on(t,r),this},r.prototype.removeListener=function(t,e){var r,i,s,a;if(!n(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],s=r.length,i=-1,r===e||n(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(r)){for(a=s;a-->0;)if(r[a]===e||r[a].listener&&r[a].listener===e){i=a;break}if(0>i)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],n(r))this.removeListener(t,r);else for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?n(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.listenerCount=function(t,e){var r;return r=t._events&&t._events[e]?n(t._events[e])?1:t._events[e].length:0}},{}],45:[function(t,e){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})
}:function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],46:[function(t,e){function r(){}var n=e.exports={};n.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var r=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),r.length>0)){var n=r.shift();n()}},!0),function(t){r.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.on=r,n.addListener=r,n.once=r,n.off=r,n.removeListener=r,n.removeAllListeners=r,n.emit=r,n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],47:[function(t,e){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],48:[function(t,e,r){(function(e,n){function i(t,e){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),y(e)?n.showHidden=e:e&&r._extend(n,e),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),u(n,t,n.depth)}function o(t,e){var r=i.styles[e];return r?"["+i.colors[r][0]+"m"+t+"["+i.colors[r][1]+"m":t}function s(t){return t}function a(t){var e={};return t.forEach(function(t){e[t]=!0}),e}function u(t,e,n){if(t.customInspect&&e&&S(e.inspect)&&e.inspect!==r.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(n,t);return v(i)||(i=u(t,i,n)),i}var o=f(t,e);if(o)return o;var s=Object.keys(e),y=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),E(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(e);if(0===s.length){if(S(e)){var g=e.name?": "+e.name:"";return t.stylize("[Function"+g+"]","special")}if(O(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(A(e))return t.stylize(Date.prototype.toString.call(e),"date");if(E(e))return c(e)}var _="",m=!1,b=["{","}"];if(d(e)&&(m=!0,b=["[","]"]),S(e)){var w=e.name?": "+e.name:"";_=" [Function"+w+"]"}if(O(e)&&(_=" "+RegExp.prototype.toString.call(e)),A(e)&&(_=" "+Date.prototype.toUTCString.call(e)),E(e)&&(_=" "+c(e)),0===s.length&&(!m||0==e.length))return b[0]+_+b[1];if(0>n)return O(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var B;return B=m?h(t,e,n,y,s):s.map(function(r){return p(t,e,n,y,r,m)}),t.seen.pop(),l(B,_,b)}function f(t,e){if(w(e))return t.stylize("undefined","undefined");if(v(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}return m(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,r,n,i){for(var o=[],s=0,a=e.length;a>s;++s)o.push(j(e,String(s))?p(t,e,r,n,String(s),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(t,e,r,n,i,!0))}),o}function p(t,e,r,n,i,o){var s,a,f;if(f=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},f.get?a=f.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):f.set&&(a=t.stylize("[Setter]","special")),j(n,i)||(s="["+i+"]"),a||(t.seen.indexOf(f.value)<0?(a=g(r)?u(t,f.value,null):u(t,f.value,r-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function l(t,e,r){var n=0,i=t.reduce(function(t,e){return n++,e.indexOf("\n")>=0&&n++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1]:r[0]+e+" "+t.join(", ")+" "+r[1]}function d(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function g(t){return null===t}function _(t){return null==t}function m(t){return"number"==typeof t}function v(t){return"string"==typeof t}function b(t){return"symbol"==typeof t}function w(t){return void 0===t}function O(t){return B(t)&&"[object RegExp]"===T(t)}function B(t){return"object"==typeof t&&null!==t}function A(t){return B(t)&&"[object Date]"===T(t)}function E(t){return B(t)&&("[object Error]"===T(t)||t instanceof Error)}function S(t){return"function"==typeof t}function N(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function T(t){return Object.prototype.toString.call(t)}function $(t){return 10>t?"0"+t.toString(10):t.toString(10)}function x(){var t=new Date,e=[$(t.getHours()),$(t.getMinutes()),$(t.getSeconds())].join(":");return[t.getDate(),M[t.getMonth()],e].join(" ")}function j(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var D=/%[sdj%]/g;r.format=function(t){if(!v(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(i(arguments[r]));return e.join(" ")}for(var r=1,n=arguments,o=n.length,s=String(t).replace(D,function(t){if("%%"===t)return"%";if(r>=o)return t;switch(t){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(t){return"[Circular]"}default:return t}}),a=n[r];o>r;a=n[++r])s+=g(a)||!B(a)?" "+a:" "+i(a);return s},r.deprecate=function(t,i){function o(){if(!s){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),s=!0}return t.apply(this,arguments)}if(w(n.process))return function(){return r.deprecate(t,i).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return o};var I,R={};r.debuglog=function(t){if(w(I)&&(I=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!R[t])if(new RegExp("\\b"+t+"\\b","i").test(I)){var n=e.pid;R[t]=function(){var e=r.format.apply(r,arguments);console.error("%s %d: %s",t,n,e)}}else R[t]=function(){};return R[t]},r.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},r.isArray=d,r.isBoolean=y,r.isNull=g,r.isNullOrUndefined=_,r.isNumber=m,r.isString=v,r.isSymbol=b,r.isUndefined=w,r.isRegExp=O,r.isObject=B,r.isDate=A,r.isError=E,r.isFunction=S,r.isPrimitive=N,r.isBuffer=t("./support/isBuffer");var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];r.log=function(){console.log("%s - %s",x(),r.format.apply(r,arguments))},r.inherits=t("inherits"),r._extend=function(t,e){if(!e||!B(e))return t;for(var r=Object.keys(e),n=r.length;n--;)t[r[n]]=e[r[n]];return t}}).call(this,t("FWaASH"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":47,FWaASH:46,inherits:45}],49:[function(t,e){function r(t,e){return function r(){return r.hookCalled?void 0:(r.hookCalled=!0,t.apply(e,arguments))}}e.exports={hook:function(t,e,n){if(1!==arguments.length||"object"!=typeof t){var i=this.prototype||this,o=i._pres=i._pres||{},s=i._posts=i._posts||{};return o[t]=o[t]||[],s[t]=s[t]||[],i[t]=function(){function o(t){return t&&t instanceof Error?s(t):void(--d||g.apply(u,a))}function s(t){if("function"==typeof f)return f(t);if(n)return n.call(u,t);throw t}var a,u=this,f=arguments[arguments.length-1],c=this._pres[t],h=this._posts[t],p=c.length,l=-1,d=i[t].numAsyncPres,y=function(){if(arguments[0]instanceof Error)return s(arguments[0]);var e,n,h=Array.prototype.slice.call(arguments);if(!h.length||null==arguments[0]&&"function"==typeof f||(a=h),++l<p){if(e=c[l],e.isAsync&&e.length<2)throw new Error("Your pre must have next and done arguments -- e.g., function (next, done, ...)");if(e.length<1)throw new Error("Your pre must have a next argument -- e.g., function (next, ...)");return n=(e.isAsync?[r(y),r(o)]:[r(y)]).concat(a),e.apply(u,n)}return i[t].numAsyncPres?void 0:g.apply(u,a)},g=function(){var t,n,i,o,c=Array.prototype.slice.call(arguments);return l===p?(o=function(){if(arguments[0]instanceof Error)return s(arguments[0]);var t,e,c=Array.prototype.slice.call(arguments,1);if(c.length&&(a=c),++i<n){if(t=h[i],t.length<1)throw new Error("Your post must have a next argument -- e.g., function (next, ...)");return e=[r(o)].concat(a),t.apply(u,e)}return"function"==typeof f?f.apply(u,arguments):void 0},"function"==typeof f&&(c[c.length-1]=r(o)),n=h.length,i=-1,t=e.apply(u,c),n&&"function"!=typeof f?o():t):void 0};return y.apply(this,arguments)},i[t].numAsyncPres=0,this}for(var a in t)this.hook(a,t[a])},pre:function(t,e,r,n){"boolean"!=typeof arguments[1]&&(n=r,r=e,e=!1);var i=this.prototype||this,o=i._pres=i._pres||{};return this._lazySetupHooks(i,t,n),(r.isAsync=e)&&i[t].numAsyncPres++,(o[t]=o[t]||[]).push(r),this},post:function(t,e,r){2===arguments.length&&(r=e,e=!1);var n=this.prototype||this,i=n._posts=n._posts||{};return this._lazySetupHooks(n,t),(i[t]=i[t]||[]).push(r),this},removePre:function(t,e){var r=this.prototype||this,n=r._pres||r._pres||{};return n[t]?(1===arguments.length?n[t].length=0:n[t]=n[t].filter(function(t){return t!==e}),this):this},_lazySetupHooks:function(t,e,r){"undefined"==typeof t[e].numAsyncPres&&this.hook(e,t[e],r)}}},{}],50:[function(t,e){(function(t){"use strict";function r(){this._pres={},this._posts={}}r.prototype.execPre=function(e,r,n){var i=this._pres[e]||[],o=i.length,s=i.numAsync||0,a=0,u=s,f=!1;if(!o)return t.nextTick(function(){n()});var c=function(){var e=i[a];if(e.isAsync)e.fn.call(r,function(t){if(t){if(f)return;return f=!0,n(t)}++a,c()},function(t){if(t){if(f)return;return f=!0,n(t)}return 0===--s?n():void 0});else if(e.fn.length>0)e.fn.call(r,function(t){if(t){if(f)return;return f=!0,n(t)}return++a>=o?u>0?void 0:n():void c()});else{if(e.fn.call(r),++a>=o)return u>0?void 0:t.nextTick(function(){n()});c()}};c()},r.prototype.execPost=function(e,r,n,i){var o=this._posts[e]||[],s=o.length,a=0,u=!1;if(!s)return t.nextTick(function(){i.apply(null,[void 0].concat(n))});var f=function(){var t=o[a];if(t.length>n.length)t.apply(r,n.concat(function(t){if(t){if(u)return;return i(t)}return++a>=s?i.apply(null,[void 0].concat(n)):void f()}));else{if(t.apply(r,n),++a>=s)return i.apply(null,[void 0].concat(n));f()}};f()},r.prototype.wrap=function(t,e,r,n){var i=n.length>0?n[n.length-1]:null,o=this;this.execPre(t,r,function(s){if(s){if("function"==typeof i)return i(s)}else{var a="function"==typeof i?n.length-1:n.length;e.apply(r,n.slice(0,a).concat(function(){if(arguments[0])return"function"==typeof i?i(arguments[0]):void 0;var e=Array.prototype.slice.call(arguments,1);o.execPost(t,r,e,function(){return arguments[0]?"function"==typeof i?i(arguments[0]):void 0:"function"==typeof i?i.apply(r,arguments):void 0})}))}})},r.prototype.pre=function(t,e,r,n){"boolean"!=typeof arguments[1]&&(n=r,r=e,e=!1),this._pres[t]=this._pres[t]||[];var i=this._pres[t];return e&&(i.numAsync=i.numAsync||0,++i.numAsync),i.push({fn:r,isAsync:e}),this},r.prototype.post=function(t,e){return(this._posts[t]=this._posts[t]||[]).push(e),this},e.exports=r}).call(this,t("FWaASH"))},{FWaASH:46}],51:[function(t,e,r){var n=function(t,e){return this instanceof n?(this._type="ReadPreference",this.mode=t,void(this.tags=e)):new n(t,e)};n.isValid=function(t){return t==n.PRIMARY||t==n.PRIMARY_PREFERRED||t==n.SECONDARY||t==n.SECONDARY_PREFERRED||t==n.NEAREST||1==t||0==t||null==t},n.prototype.isValid=function(t){var e="string"==typeof t?t:this.mode;return n.isValid(e)},n.prototype.toObject=function(){var t={mode:this.mode};return null!=this.tags&&(t.tags=this.tags),t},n.PRIMARY="primary",n.PRIMARY_PREFERRED="primaryPreferred",n.SECONDARY="secondary",n.SECONDARY_PREFERRED="secondaryPreferred",n.NEAREST="nearest",r.ReadPreference=n},{}],52:[function(t,e){function r(t,e){if(!(this instanceof r))return new r(t,e);if(this._bsontype="Binary",t instanceof Number?(this.sub_type=t,this.position=0):(this.sub_type=null==e?i:e,this.position=0),null==t||t instanceof Number)this.buffer="undefined"!=typeof n?new n(r.BUFFER_SIZE):"undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(r.BUFFER_SIZE)):new Array(r.BUFFER_SIZE),this.position=0;else{if("string"==typeof t)if("undefined"!=typeof n)this.buffer=new n(t);else{if("undefined"==typeof Uint8Array&&"[object Array]"!=Object.prototype.toString.call(t))throw new Error("only String, Buffer, Uint8Array or Array accepted");this.buffer=o(t)}else this.buffer=t;this.position=t.length}}if("undefined"==typeof window)var n=t("buffer").Buffer;r.prototype.put=function(t){if(null!=t.length&&"number"!=typeof t&&1!=t.length)throw new Error("only accepts single character String, Uint8Array or Array");if("number"!=typeof t&&0>t||t>255)throw new Error("only accepts number in a valid unsigned byte range 0-255");var e=null;if(e="string"==typeof t?t.charCodeAt(0):null!=t.length?t[0]:t,this.buffer.length>this.position)this.buffer[this.position++]=e;else if("undefined"!=typeof n&&n.isBuffer(this.buffer)){var i=new n(r.BUFFER_SIZE+this.buffer.length);this.buffer.copy(i,0,0,this.buffer.length),this.buffer=i,this.buffer[this.position++]=e}else{var i=null;i="[object Uint8Array]"==Object.prototype.toString.call(this.buffer)?new Uint8Array(new ArrayBuffer(r.BUFFER_SIZE+this.buffer.length)):new Array(r.BUFFER_SIZE+this.buffer.length);for(var o=0;o<this.buffer.length;o++)i[o]=this.buffer[o];this.buffer=i,this.buffer[this.position++]=e}},r.prototype.write=function(t,e){if(e="number"==typeof e?e:this.position,this.buffer.length<e+t.length){var r=null;if("undefined"!=typeof n&&n.isBuffer(this.buffer))r=new n(this.buffer.length+t.length),this.buffer.copy(r,0,0,this.buffer.length);else if("[object Uint8Array]"==Object.prototype.toString.call(this.buffer)){r=new Uint8Array(new ArrayBuffer(this.buffer.length+t.length));for(var i=0;i<this.position;i++)r[i]=this.buffer[i]}this.buffer=r}if("undefined"!=typeof n&&n.isBuffer(t)&&n.isBuffer(this.buffer))t.copy(this.buffer,e,0,t.length),this.position=e+t.length>this.position?e+t.length:this.position;else if("undefined"!=typeof n&&"string"==typeof t&&n.isBuffer(this.buffer))this.buffer.write(t,"binary",e),this.position=e+t.length>this.position?e+t.length:this.position;else if("[object Uint8Array]"==Object.prototype.toString.call(t)||"[object Array]"==Object.prototype.toString.call(t)&&"string"!=typeof t){for(var i=0;i<t.length;i++)this.buffer[e++]=t[i];this.position=e>this.position?e:this.position}else if("string"==typeof t){for(var i=0;i<t.length;i++)this.buffer[e++]=t.charCodeAt(i);this.position=e>this.position?e:this.position}},r.prototype.read=function(t,e){if(e=e&&e>0?e:this.position,this.buffer.slice)return this.buffer.slice(t,t+e);for(var r="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(e)):new Array(e),n=0;e>n;n++)r[n]=this.buffer[t++];return r},r.prototype.value=function(t){if(t=null==t?!1:t,t&&"undefined"!=typeof n&&n.isBuffer(this.buffer)&&this.buffer.length==this.position)return this.buffer;if("undefined"!=typeof n&&n.isBuffer(this.buffer))return t?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position);if(t){if(null!=this.buffer.slice)return this.buffer.slice(0,this.position);for(var e="[object Uint8Array]"==Object.prototype.toString.call(this.buffer)?new Uint8Array(new ArrayBuffer(this.position)):new Array(this.position),r=0;r<this.position;r++)e[r]=this.buffer[r];return e}return s(this.buffer,0,this.position)},r.prototype.length=function(){return this.position},r.prototype.toJSON=function(){return null!=this.buffer?this.buffer.toString("base64"):""},r.prototype.toString=function(t){return null!=this.buffer?this.buffer.slice(0,this.position).toString(t):""};var i=0,o=function(t){for(var e="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(t.length)):new Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e},s=function(t,e,r){for(var n="",i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n};r.BUFFER_SIZE=256,r.SUBTYPE_DEFAULT=0,r.SUBTYPE_FUNCTION=1,r.SUBTYPE_BYTE_ARRAY=2,r.SUBTYPE_UUID_OLD=3,r.SUBTYPE_UUID=4,r.SUBTYPE_MD5=5,r.SUBTYPE_USER_DEFINED=128,e.exports=r,e.exports.Binary=r},{buffer:40}],53:[function(t,e,n){(function(e){function i(t,e){return this instanceof i?(this.bigEndian=t,void(this.allowExceptions=e)):new i(t,e)}function o(t,e){this.bigEndian=t||0,this.buffer=[],this.setBuffer(e)}for(var s=String.fromCharCode,a=[],u=0;64>u;u++)a[u]=Math.pow(2,u);i.warn=function(t){if(this.allowExceptions)throw new Error(t);return 1},i.decodeFloat=function(t,e,r){var n=new this.Buffer(this.bigEndian,t);n.checkBuffer(e+r+1);var i=a[r-1]-1,o=n.readBits(e+r,1),s=n.readBits(e,r),u=0,f=2,c=n.buffer.length+(-e>>3)-1;do for(var h=n.buffer[++c],p=e%8||8,l=1<<p;l>>=1;h&l&&(u+=1/f),f*=2);while(e-=p);return s==(i<<1)+1?u?0/0:o?-1/0:+1/0:(1+-2*o)*(s||u?s?Math.pow(2,s-i)*(1+u):Math.pow(2,-i+1)*u:0)},i.decodeInt=function(t,e,r,n){var i=new this.Buffer(this.bigEndian||n,t),o=i.readBits(0,e),s=a[e];return r&&o>=s/2?o-s:o},i.encodeFloat=function(t,e,n){var i,o,s,u,f,c=a[n-1]-1,h=-c+1,p=c,l=h-e,d=parseFloat(t),y=isNaN(d)||d==-1/0||d==+1/0?d:0,g=0,_=2*c+1+e+3,m=new Array(_),v=(d=0!==y?0:d)<0,b=Math.floor(d=Math.abs(d)),w=d-b;for(u=_;u;m[--u]=0);for(u=c+2;b&&u;m[--u]=b%2,b=Math.floor(b/2));for(u=c+1;w>0&&u;(m[++u]=((w*=2)>=1)-0)&&--w);for(u=-1;++u<_&&!m[u];);if(m[(i=e-1+(u=(g=c+1-u)>=h&&p>=g?u+1:c+1-(g=h-1)))+1]){if(!(o=m[i]))for(f=i+2;!o&&_>f;o=m[f++]);for(f=i+1;o&&--f>=0;(m[f]=!m[f]-0)&&(o=0));}for(u=0>u-2?-1:u-3;++u<_&&!m[u];);for((g=c+1-u)>=h&&p>=g?++u:h>g&&(g!=c+1-_&&l>g&&this.warn("encodeFloat::float underflow"),u=c+1-(g=h-1)),(b||0!==y)&&(this.warn(b?"encodeFloat::float overflow":"encodeFloat::"+y),g=p+1,u=c+2,y==-1/0?v=1:isNaN(y)&&(m[u]=1)),d=Math.abs(g+c),f=n+1,s="";--f;s=d%2+s,d=d>>=1);for(d=0,f=0,u=(s=(v?"1":"0")+s+m.slice(u,u+e).join("")).length,r=[];u;f=(f+1)%8)d+=(1<<f)*s.charAt(--u),7==f&&(r[r.length]=String.fromCharCode(d),d=0);return r[r.length]=d?String.fromCharCode(d):"",(this.bigEndian?r.reverse():r).join("")},i.encodeInt=function(t,e,r,n){var i=a[e];(t>=i||-(i/2)>t)&&(this.warn("encodeInt::overflow"),t=0),0>t&&(t+=i);for(var o=[];t;o[o.length]=String.fromCharCode(t%256),t=Math.floor(t/256));for(e=-(-e>>3)-o.length;e--;o[o.length]="\x00");return(this.bigEndian||n?o.reverse():o).join("")},i.toSmall=function(t){return this.decodeInt(t,8,!0)},i.fromSmall=function(t){return this.encodeInt(t,8,!0)},i.toByte=function(t){return this.decodeInt(t,8,!1)},i.fromByte=function(t){return this.encodeInt(t,8,!1)},i.toShort=function(t){return this.decodeInt(t,16,!0)},i.fromShort=function(t){return this.encodeInt(t,16,!0)},i.toWord=function(t){return this.decodeInt(t,16,!1)},i.fromWord=function(t){return this.encodeInt(t,16,!1)},i.toInt=function(t){return this.decodeInt(t,32,!0)},i.fromInt=function(t){return this.encodeInt(t,32,!0)},i.toLong=function(t){return this.decodeInt(t,64,!0)},i.fromLong=function(t){return this.encodeInt(t,64,!0)},i.toDWord=function(t){return this.decodeInt(t,32,!1)},i.fromDWord=function(t){return this.encodeInt(t,32,!1)},i.toQWord=function(t){return this.decodeInt(t,64,!0)},i.fromQWord=function(t){return this.encodeInt(t,64,!0)},i.toFloat=function(t){return this.decodeFloat(t,23,8)},i.fromFloat=function(t){return this.encodeFloat(t,23,8)},i.toDouble=function(t){return this.decodeFloat(t,52,11)},i.fromDouble=function(t){return this.encodeFloat(t,52,11)},i.encode_int32=function(t,e){var r,n,i,o,a;return a=0>t?t+4294967296:t,r=Math.floor(a/16777215),a&=16777215,n=Math.floor(a/65535),a&=65535,i=Math.floor(a/255),a&=255,o=Math.floor(a),e?[s(r),s(n),s(i),s(o)]:s(r)+s(n)+s(i)+s(o)},i.encode_int64=function(t){var e,r,n,i,o,a,u,f,c;return c=0>t?t+0x10000000000000000:t,e=Math.floor(c/72057594037927940),c&=72057594037927940,r=Math.floor(c/0xffffffffffff),c&=0xffffffffffff,n=Math.floor(c/0xffffffffff),c&=0xffffffffff,i=Math.floor(c/4294967295),c&=4294967295,o=Math.floor(c/16777215),c&=16777215,a=Math.floor(c/65535),c&=65535,u=Math.floor(c/255),c&=255,f=Math.floor(c),s(e)+s(r)+s(n)+s(i)+s(o)+s(a)+s(u)+s(f)},i.decode_utf8=function(t){for(var e,r=t.length,n="",i=0,o=0,s=0;r>i;)o=t.charCodeAt(i),128>o?(n+=String.fromCharCode(o),i++):o>191&&224>o?(s=t.charCodeAt(i+1),n+=String.fromCharCode((31&o)<<6|63&s),i+=2):(s=t.charCodeAt(i+1),e=t.charCodeAt(i+2),n+=String.fromCharCode((15&o)<<12|(63&s)<<6|63&e),i+=3);return n},i.encode_cstring=function(t){return unescape(encodeURIComponent(t))+i.fromByte(0)},i.encode_utf8=function(t){for(var e,r="",n=0,i=t.length;i>n;n++)e=t.charCodeAt(n),128>e?r+=String.fromCharCode(e):e>127&&2048>e?(r+=String.fromCharCode(e>>6|192),r+=String.fromCharCode(63&e|128)):(r+=String.fromCharCode(e>>12|224),r+=String.fromCharCode(e>>6&63|128),r+=String.fromCharCode(63&e|128));return r},i.hprint=function(t){for(var r,n=0,i=t.length;i>n;n++)t.charCodeAt(n)<32?(r=t.charCodeAt(n)<=15?"0"+t.charCodeAt(n).toString(16):t.charCodeAt(n).toString(16),e.stdout.write(r+" ")):(r=t.charCodeAt(n)<=15?"0"+t.charCodeAt(n).toString(16):t.charCodeAt(n).toString(16),e.stdout.write(r+" "));e.stdout.write("\n\n")},i.ilprint=function(e){for(var r,n=0,i=e.length;i>n;n++)e.charCodeAt(n)<32?(r=e.charCodeAt(n)<=15?"0"+e.charCodeAt(n).toString(10):e.charCodeAt(n).toString(10),t("util").debug(r+" : ")):(r=e.charCodeAt(n)<=15?"0"+e.charCodeAt(n).toString(10):e.charCodeAt(n).toString(10),t("util").debug(r+" : "+e.charAt(n)))},i.hlprint=function(e){for(var r,n=0,i=e.length;i>n;n++)e.charCodeAt(n)<32?(r=e.charCodeAt(n)<=15?"0"+e.charCodeAt(n).toString(16):e.charCodeAt(n).toString(16),t("util").debug(r+" : ")):(r=e.charCodeAt(n)<=15?"0"+e.charCodeAt(n).toString(16):e.charCodeAt(n).toString(16),t("util").debug(r+" : "+e.charAt(n)))},o.prototype.setBuffer=function(t){var e,r,n;if(t){for(r=e=t.length,n=this.buffer=new Array(e);r;n[e-r]=t.charCodeAt(--r));this.bigEndian&&n.reverse()}},o.prototype.hasNeededBits=function(t){return this.buffer.length>=-(-t>>3)},o.prototype.checkBuffer=function(t){if(!this.hasNeededBits(t))throw new Error("checkBuffer::missing bytes")},o.prototype.readBits=function(t,e){function r(t,e){for(;e--;t=1073741824==(1073741824&(t%=2147483648))?2*t:2*(t-1073741824)+2147483647+1);return t}if(0>t||0>=e)return 0;this.checkBuffer(t+e);for(var n,i=t%8,o=this.buffer.length-(t>>3)-1,s=this.buffer.length+(-(t+e)>>3),a=o-s,u=(this.buffer[o]>>i&(1<<(a?8-i:e))-1)+(a&&(n=(t+e)%8)?(this.buffer[s++]&(1<<n)-1)<<(a--<<3)-i:0);a;u+=r(this.buffer[s++],(a--<<3)-i));return u},i.Buffer=o,n.BinaryParser=i}).call(this,t("FWaASH"))},{FWaASH:46,util:48}],54:[function(require,module,exports){(function(Buffer){function BSON(){}function calculateElement(t,e,r){var n="undefined"!=typeof Buffer;switch(e&&e.toBSON&&(e=e.toBSON()),typeof e){case"string":return 1+(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1+4+(n?Buffer.byteLength(e,"utf8"):numberOfBytes(e))+1;case"number":return Math.floor(e)===e&&e>=BSON.JS_INT_MIN&&e<=BSON.JS_INT_MAX&&e>=BSON.BSON_INT32_MIN&&e<=BSON.BSON_INT32_MAX?(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+5:(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+9;case"undefined":return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+1;case"boolean":return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+2;case"object":if(null==e||e instanceof MinKey||e instanceof MaxKey||"MinKey"==e._bsontype||"MaxKey"==e._bsontype)return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+1;if(e instanceof ObjectID||"ObjectID"==e._bsontype)return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+13;if(e instanceof Date||isDate(e))return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+9;if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+6+e.length;if(e instanceof Long||e instanceof Double||e instanceof Timestamp||"Long"==e._bsontype||"Double"==e._bsontype||"Timestamp"==e._bsontype)return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+9;if(e instanceof Code||"Code"==e._bsontype)return null!=e.scope&&Object.keys(e.scope).length>0?(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+1+4+4+(n?Buffer.byteLength(e.code.toString(),"utf8"):numberOfBytes(e.code.toString()))+1+BSON.calculateObjectSize(e.scope,r):(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+1+4+(n?Buffer.byteLength(e.code.toString(),"utf8"):numberOfBytes(e.code.toString()))+1;if(e instanceof Binary||"Binary"==e._bsontype)return e.sub_type==Binary.SUBTYPE_BYTE_ARRAY?(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+(e.position+1+4+1+4):(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+(e.position+1+4+1);if(e instanceof Symbol||"Symbol"==e._bsontype)return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+((n?Buffer.byteLength(e.value,"utf8"):numberOfBytes(e.value))+4+1+1);if(e instanceof DBRef||"DBRef"==e._bsontype){var i={$ref:e.namespace,$id:e.oid};return null!=e.db&&(i.$db=e.db),(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+1+BSON.calculateObjectSize(i,r)}return e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)?(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+1+(n?Buffer.byteLength(e.source,"utf8"):numberOfBytes(e.source))+1+(e.global?1:0)+(e.ignoreCase?1:0)+(e.multiline?1:0)+1:(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+BSON.calculateObjectSize(e,r)+1;case"function":if(e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)||"[object RegExp]"==String.call(e))return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+1+(n?Buffer.byteLength(e.source,"utf8"):numberOfBytes(e.source))+1+(e.global?1:0)+(e.ignoreCase?1:0)+(e.multiline?1:0)+1;if(r&&null!=e.scope&&Object.keys(e.scope).length>0)return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+1+4+4+(n?Buffer.byteLength(e.toString(),"utf8"):numberOfBytes(e.toString()))+1+BSON.calculateObjectSize(e.scope,r);if(r)return(null!=t?(n?Buffer.byteLength(t,"utf8"):numberOfBytes(t))+1:0)+1+4+(n?Buffer.byteLength(e.toString(),"utf8"):numberOfBytes(e.toString()))+1}return 0}var Long=require("./long").Long,Double=require("./double").Double,Timestamp=require("./timestamp").Timestamp,ObjectID=require("./objectid").ObjectID,Symbol=require("./symbol").Symbol,Code=require("./code").Code,MinKey=require("./min_key").MinKey,MaxKey=require("./max_key").MaxKey,DBRef=require("./db_ref").DBRef,Binary=require("./binary").Binary,BinaryParser=require("./binary_parser").BinaryParser,writeIEEE754=require("./float_parser").writeIEEE754,readIEEE754=require("./float_parser").readIEEE754,isDate=function(t){return"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)};BSON.BSON_INT32_MAX=2147483647,BSON.BSON_INT32_MIN=-2147483648,BSON.BSON_INT64_MAX=Math.pow(2,63)-1,BSON.BSON_INT64_MIN=-Math.pow(2,63),BSON.JS_INT_MAX=9007199254740992,BSON.JS_INT_MIN=-9007199254740992;var JS_INT_MAX_LONG=Long.fromNumber(9007199254740992),JS_INT_MIN_LONG=Long.fromNumber(-9007199254740992);BSON.BSON_DATA_NUMBER=1,BSON.BSON_DATA_STRING=2,BSON.BSON_DATA_OBJECT=3,BSON.BSON_DATA_ARRAY=4,BSON.BSON_DATA_BINARY=5,BSON.BSON_DATA_UNDEFINED=6,BSON.BSON_DATA_OID=7,BSON.BSON_DATA_BOOLEAN=8,BSON.BSON_DATA_DATE=9,BSON.BSON_DATA_NULL=10,BSON.BSON_DATA_REGEXP=11,BSON.BSON_DATA_CODE=13,BSON.BSON_DATA_SYMBOL=14,BSON.BSON_DATA_CODE_W_SCOPE=15,BSON.BSON_DATA_INT=16,BSON.BSON_DATA_TIMESTAMP=17,BSON.BSON_DATA_LONG=18,BSON.BSON_DATA_MIN_KEY=255,BSON.BSON_DATA_MAX_KEY=127,BSON.BSON_BINARY_SUBTYPE_DEFAULT=0,BSON.BSON_BINARY_SUBTYPE_FUNCTION=1,BSON.BSON_BINARY_SUBTYPE_BYTE_ARRAY=2,BSON.BSON_BINARY_SUBTYPE_UUID=3,BSON.BSON_BINARY_SUBTYPE_MD5=4,BSON.BSON_BINARY_SUBTYPE_USER_DEFINED=128,BSON.calculateObjectSize=function(t,e){var r=5;if(Array.isArray(t))for(var n=0;n<t.length;n++)r+=calculateElement(n.toString(),t[n],e);else{t.toBSON&&(t=t.toBSON());for(var i in t)r+=calculateElement(i,t[i],e)}return r},BSON.serializeWithBufferAndIndex=function(t,e,r,n,i){i=null==i?!1:i;var o=r.length;return r[n++]=255&o,r[n++]=o>>8&255,r[n++]=o>>16&255,r[n++]=o>>24&255,serializeObject(t,e,r,n,i)-1};var serializeObject=function(t,e,r,n,i){if(t.toBSON){if("function"!=typeof t.toBSON)throw new Error("toBSON is not a function");if(t=t.toBSON(),null!=t&&"object"!=typeof t)throw new Error("toBSON function did not return an object")}if(Array.isArray(t))for(var o=0;o<t.length;o++)n=packElement(o.toString(),t[o],e,r,n,i);else{t.toBSON&&(t=t.toBSON());for(var s in t)"$db"!=s&&"$ref"!=s&&"$id"!=s&&BSON.checkKey(s,!e),n=packElement(s,t[s],e,r,n,i)}return r[n++]=0,n},stringToBytes=function(t){for(var e,r,n=[],i=0;i<t.length;i++){e=t.charCodeAt(i),r=[];do r.push(255&e),e>>=8;while(e);n=n.concat(r.reverse())}return n},numberOfBytes=function(t){for(var e,r,n=0,i=0;i<t.length;i++){e=t.charCodeAt(i),r=[];do r.push(255&e),e>>=8;while(e);n+=r.length}return n},writeToTypedArray=function(t,e,r){for(var n=stringToBytes(e),i=0;i<n.length;i++)t[r+i]=n[i];return n.length},supportsBuffer="undefined"!=typeof Buffer,packElement=function(t,e,r,n,i,o){e&&e.toBSON&&(e=e.toBSON());switch(typeof e){case"string":n[i++]=BSON.BSON_DATA_STRING;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var a=supportsBuffer?Buffer.byteLength(e)+1:numberOfBytes(e)+1;return n[i+3]=a>>24&255,n[i+2]=a>>16&255,n[i+1]=a>>8&255,n[i]=255&a,i+=4,supportsBuffer?n.write(e,i,"utf8"):writeToTypedArray(n,e,i),i=i+a-1,n[i++]=0,i;case"number":if(Math.floor(e)===e&&e>=BSON.JS_INT_MIN&&e<=BSON.JS_INT_MAX)if(e>=BSON.BSON_INT32_MIN&&e<=BSON.BSON_INT32_MAX){n[i++]=BSON.BSON_DATA_INT;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0,n[i++]=255&e,n[i++]=e>>8&255,n[i++]=e>>16&255,n[i++]=e>>24&255}else if(e>=BSON.JS_INT_MIN&&e<=BSON.JS_INT_MAX){n[i++]=BSON.BSON_DATA_NUMBER;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0,writeIEEE754(n,e,i,"little",52,8),i+=8}else{n[i++]=BSON.BSON_DATA_LONG;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var u=Long.fromNumber(e),f=u.getLowBits(),c=u.getHighBits();n[i++]=255&f,n[i++]=f>>8&255,n[i++]=f>>16&255,n[i++]=f>>24&255,n[i++]=255&c,n[i++]=c>>8&255,n[i++]=c>>16&255,n[i++]=c>>24&255}else{n[i++]=BSON.BSON_DATA_NUMBER;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0,writeIEEE754(n,e,i,"little",52,8),i+=8}return i;case"undefined":n[i++]=BSON.BSON_DATA_NULL;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);return i=i+s+1,n[i-1]=0,i;case"boolean":n[i++]=BSON.BSON_DATA_BOOLEAN;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);return i=i+s+1,n[i-1]=0,n[i++]=e?1:0,i;case"object":if(null===e||e instanceof MinKey||e instanceof MaxKey||"MinKey"==e._bsontype||"MaxKey"==e._bsontype){n[i++]=null===e?BSON.BSON_DATA_NULL:e instanceof MinKey?BSON.BSON_DATA_MIN_KEY:BSON.BSON_DATA_MAX_KEY;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);return i=i+s+1,n[i-1]=0,i}if(e instanceof ObjectID||"ObjectID"==e._bsontype){n[i++]=BSON.BSON_DATA_OID;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);return i=i+s+1,n[i-1]=0,supportsBuffer?n.write(e.id,i,"binary"):writeToTypedArray(n,e.id,i),i+=12}if(e instanceof Date||isDate(e)){n[i++]=BSON.BSON_DATA_DATE;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var h=Long.fromNumber(e.getTime()),f=h.getLowBits(),c=h.getHighBits();return n[i++]=255&f,n[i++]=f>>8&255,n[i++]=f>>16&255,n[i++]=f>>24&255,n[i++]=255&c,n[i++]=c>>8&255,n[i++]=c>>16&255,n[i++]=c>>24&255,i
}if("undefined"!=typeof Buffer&&Buffer.isBuffer(e)){n[i++]=BSON.BSON_DATA_BINARY;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var a=e.length;return n[i++]=255&a,n[i++]=a>>8&255,n[i++]=a>>16&255,n[i++]=a>>24&255,n[i++]=BSON.BSON_BINARY_SUBTYPE_DEFAULT,e.copy(n,i,0,a),i+=a}if(e instanceof Long||e instanceof Timestamp||"Long"==e._bsontype||"Timestamp"==e._bsontype){n[i++]=e instanceof Long||"Long"==e._bsontype?BSON.BSON_DATA_LONG:BSON.BSON_DATA_TIMESTAMP;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var f=e.getLowBits(),c=e.getHighBits();return n[i++]=255&f,n[i++]=f>>8&255,n[i++]=f>>16&255,n[i++]=f>>24&255,n[i++]=255&c,n[i++]=c>>8&255,n[i++]=c>>16&255,n[i++]=c>>24&255,i}if(e instanceof Double||"Double"==e._bsontype){n[i++]=BSON.BSON_DATA_NUMBER;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);return i=i+s+1,n[i-1]=0,writeIEEE754(n,e,i,"little",52,8),i+=8}if(e instanceof Code||"Code"==e._bsontype){if(null!=e.scope&&Object.keys(e.scope).length>0){n[i++]=BSON.BSON_DATA_CODE_W_SCOPE;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var p=BSON.calculateObjectSize(e.scope,o),l=e.code.toString(),d=supportsBuffer?Buffer.byteLength(l)+1:numberOfBytes(l)+1,y=4+d+p+4;n[i++]=255&y,n[i++]=y>>8&255,n[i++]=y>>16&255,n[i++]=y>>24&255,n[i++]=255&d,n[i++]=d>>8&255,n[i++]=d>>16&255,n[i++]=d>>24&255,supportsBuffer?n.write(l,i,"utf8"):writeToTypedArray(n,l,i),i=i+d-1,n[i++]=0;var g=supportsBuffer?new Buffer(p):new Uint8Array(new ArrayBuffer(p));serializeObject(e.scope,r,g,0,o);var _=p;return n[i++]=255&_,n[i++]=_>>8&255,n[i++]=_>>16&255,n[i++]=_>>24&255,supportsBuffer?g.copy(n,i,0,p):n.set(g,i),i=i+_-5,n[i++]=0,i}n[i++]=BSON.BSON_DATA_CODE;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var l=e.code.toString(),a=supportsBuffer?Buffer.byteLength(l)+1:numberOfBytes(l)+1;return n[i++]=255&a,n[i++]=a>>8&255,n[i++]=a>>16&255,n[i++]=a>>24&255,supportsBuffer?n.write(l,i,"utf8"):writeToTypedArray(n,l,i),i=i+a-1,n[i++]=0,i}if(e instanceof Binary||"Binary"==e._bsontype){n[i++]=BSON.BSON_DATA_BINARY;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var m=e.value(!0),a=e.position;return n[i++]=255&a,n[i++]=a>>8&255,n[i++]=a>>16&255,n[i++]=a>>24&255,n[i++]=e.sub_type,e.sub_type==Binary.SUBTYPE_BYTE_ARRAY&&(n[i++]=255&a,n[i++]=a>>8&255,n[i++]=a>>16&255,n[i++]=a>>24&255),supportsBuffer?m.copy(n,i,0,e.position):n.set(m,i),i+=e.position}if(e instanceof Symbol||"Symbol"==e._bsontype){n[i++]=BSON.BSON_DATA_SYMBOL;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var a=supportsBuffer?Buffer.byteLength(e.value)+1:numberOfBytes(e.value)+1;return n[i++]=255&a,n[i++]=a>>8&255,n[i++]=a>>16&255,n[i++]=a>>24&255,n.write(e.value,i,"utf8"),i=i+a-1,n[i++]=0,i}if(e instanceof DBRef||"DBRef"==e._bsontype){n[i++]=BSON.BSON_DATA_OBJECT;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var v={$ref:e.namespace,$id:e.oid};null!=e.db&&(v.$db=e.db);var a=BSON.calculateObjectSize(v,o),b=BSON.serializeWithBufferAndIndex(v,r,n,i,o);return n[i++]=255&a,n[i++]=a>>8&255,n[i++]=a>>16&255,n[i++]=a>>24&255,n[b++]=0,b}if(e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)){n[i++]=BSON.BSON_DATA_REGEXP;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);return i=i+s+1,n[i-1]=0,supportsBuffer?n.write(e.source,i,"utf8"):writeToTypedArray(n,e.source,i),i+=supportsBuffer?Buffer.byteLength(e.source):numberOfBytes(e.source),n[i++]=0,e.global&&(n[i++]=115),e.ignoreCase&&(n[i++]=105),e.multiline&&(n[i++]=109),n[i++]=0,i}n[i++]=Array.isArray(e)?BSON.BSON_DATA_ARRAY:BSON.BSON_DATA_OBJECT;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var b=serializeObject(e,r,n,i+4,o),a=b-i;return n[i++]=255&a,n[i++]=a>>8&255,n[i++]=a>>16&255,n[i++]=a>>24&255,b;case"function":if(e instanceof RegExp||"[object RegExp]"===Object.prototype.toString.call(e)||"[object RegExp]"==String.call(e)){n[i++]=BSON.BSON_DATA_REGEXP;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);return i=i+s+1,n[i-1]=0,n.write(e.source,i,"utf8"),i+=supportsBuffer?Buffer.byteLength(e.source):numberOfBytes(e.source),n[i++]=0,e.global&&(n[i++]=115),e.ignoreCase&&(n[i++]=105),e.multiline&&(n[i++]=109),n[i++]=0,i}if(o&&null!=e.scope&&Object.keys(e.scope).length>0){n[i++]=BSON.BSON_DATA_CODE_W_SCOPE;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var p=BSON.calculateObjectSize(e.scope,o),l=e.toString(),d=supportsBuffer?Buffer.byteLength(l)+1:numberOfBytes(l)+1,y=4+d+p;n[i++]=255&y,n[i++]=y>>8&255,n[i++]=y>>16&255,n[i++]=y>>24&255,n[i++]=255&d,n[i++]=d>>8&255,n[i++]=d>>16&255,n[i++]=d>>24&255,supportsBuffer?n.write(l,i,"utf8"):writeToTypedArray(n,l,i),i=i+d-1,n[i++]=0;var g=new Buffer(p);serializeObject(e.scope,r,g,0,o);var _=p-4;return n[i++]=255&_,n[i++]=_>>8&255,n[i++]=_>>16&255,n[i++]=_>>24&255,g.copy(n,i,0,p),i=i+_-5,n[i++]=0,i}if(o){n[i++]=BSON.BSON_DATA_CODE;var s=supportsBuffer?n.write(t,i,"utf8"):writeToTypedArray(n,t,i);i=i+s+1,n[i-1]=0;var l=e.toString(),a=supportsBuffer?Buffer.byteLength(l)+1:numberOfBytes(l)+1;return n[i++]=255&a,n[i++]=a>>8&255,n[i++]=a>>16&255,n[i++]=a>>24&255,supportsBuffer?n.write(l,i,"utf8"):writeToTypedArray(n,l,i),i=i+a-1,n[i++]=0,i}}return i};BSON.serialize=function(t,e,r,n){if(null==t||"object"!=typeof t||Array.isArray(t))throw new Error("Only javascript objects supported");var i=null,o=BSON.calculateObjectSize(t,n);return(i="undefined"!=typeof Buffer)?(i=new Buffer(o),r=!0):i="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(o)):new Array(o),BSON.serializeWithBufferAndIndex(t,e,i,0,n),i};var functionCache=BSON.functionCache={},table=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],crc32=function(t,e,r){var n=0,i=0,o=0;n=-1^n;for(var s=e,a=r;a>s;s++)o=255&(n^t[s]),i=table[o],n=n>>>8^i;return-1^n};BSON.deserializeStream=function(t,e,r,n,i,o){o=null!=o?o:{};for(var s=e,a=0;r>a;a++){var u=t[s]|t[s+1]<<8|t[s+2]<<16|t[s+3]<<24;o.index=s,n[i+a]=BSON.deserialize(t,o),s+=u}return s};var isolateEvalWithHash=function(functionCache,hash,functionString,object){var value=null;return null==functionCache[hash]&&(eval("value = "+functionString),functionCache[hash]=value),functionCache[hash].bind(object)},isolateEval=function(functionString){var value=null;return eval("value = "+functionString),value},convertUint8ArrayToUtf8String=function(t,e,r){return BinaryParser.decode_utf8(convertArraytoUtf8BinaryString(t,e,r))},convertArraytoUtf8BinaryString=function(t,e,r){for(var n="",i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n};BSON.deserialize=function(t,e,r){e=null==e?{}:e;var n=null==e.evalFunctions?!1:e.evalFunctions,i=null==e.cacheFunctions?!1:e.cacheFunctions,o=null==e.cacheFunctionsCrc32?!1:e.cacheFunctionsCrc32,s=null==e.promoteLongs?!0:e.promoteLongs;if(t.length<5)throw new Error("corrupt bson message < 5 bytes long");var a="number"==typeof e.index?e.index:0,u=function(){for(var e=a;0!==t[e]&&e<t.length;)e++;if(e>=t.length)throw new Error("Bad BSON Document: illegal CString");var r=supportsBuffer&&Buffer.isBuffer(t)?t.toString("utf8",a,e):convertUint8ArrayToUtf8String(t,a,e);return a=e+1,r},f=r?[]:{},c=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24;if(5>c||c>t.length)throw new Error("corrupt bson message");for(;;){var h=t[a++];if(0==h)break;var p=u();switch(h){case BSON.BSON_DATA_OID:var l=supportsBuffer&&Buffer.isBuffer(t)?t.toString("binary",a,a+12):convertArraytoUtf8BinaryString(t,a,a+12);f[p]=new ObjectID(l),a+=12;break;case BSON.BSON_DATA_STRING:var d=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24;f[p]=supportsBuffer&&Buffer.isBuffer(t)?t.toString("utf8",a,a+d-1):convertUint8ArrayToUtf8String(t,a,a+d-1),a+=d;break;case BSON.BSON_DATA_INT:f[p]=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24;break;case BSON.BSON_DATA_NUMBER:f[p]=readIEEE754(t,a,"little",52,8),a+=8;break;case BSON.BSON_DATA_DATE:var y=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24,g=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24;f[p]=new Date(new Long(y,g).toNumber());break;case BSON.BSON_DATA_BOOLEAN:f[p]=1==t[a++];break;case BSON.BSON_DATA_UNDEFINED:case BSON.BSON_DATA_NULL:f[p]=null;break;case BSON.BSON_DATA_BINARY:var _=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24,m=t[a++];if(null!=t.slice)m==Binary.SUBTYPE_BYTE_ARRAY&&(_=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24),f[p]=new Binary(t.slice(a,a+_),m);else{var v="undefined"!=typeof Uint8Array?new Uint8Array(new ArrayBuffer(_)):new Array(_);m==Binary.SUBTYPE_BYTE_ARRAY&&(_=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24);for(var b=0;_>b;b++)v[b]=t[a+b];f[p]=new Binary(v,m)}a+=_;break;case BSON.BSON_DATA_ARRAY:e.index=a;var w=t[a]|t[a+1]<<8|t[a+2]<<16|t[a+3]<<24;f[p]=BSON.deserialize(t,e,!0),a+=w;break;case BSON.BSON_DATA_OBJECT:e.index=a;var w=t[a]|t[a+1]<<8|t[a+2]<<16|t[a+3]<<24;f[p]=BSON.deserialize(t,e,!1),a+=w;break;case BSON.BSON_DATA_REGEXP:for(var O=u(),B=u(),A=new Array(B.length),b=0;b<B.length;b++)switch(B[b]){case"m":A[b]="m";break;case"s":A[b]="g";break;case"i":A[b]="i"}f[p]=new RegExp(O,A.join(""));break;case BSON.BSON_DATA_LONG:var y=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24,g=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24,E=new Long(y,g);f[p]=s&&E.lessThanOrEqual(JS_INT_MAX_LONG)&&E.greaterThanOrEqual(JS_INT_MIN_LONG)?E.toNumber():E;break;case BSON.BSON_DATA_SYMBOL:var d=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24;f[p]=new Symbol(t.toString("utf8",a,a+d-1)),a+=d;break;case BSON.BSON_DATA_TIMESTAMP:var y=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24,g=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24;f[p]=new Timestamp(y,g);break;case BSON.BSON_DATA_MIN_KEY:f[p]=new MinKey;break;case BSON.BSON_DATA_MAX_KEY:f[p]=new MaxKey;break;case BSON.BSON_DATA_CODE:var d=t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24,S=supportsBuffer&&Buffer.isBuffer(t)?t.toString("utf8",a,a+d-1):convertUint8ArrayToUtf8String(t,a,a+d-1);if(n){if(i){var N=o?crc32(S):S;f[p]=isolateEvalWithHash(functionCache,N,S,f)}else f[p]=isolateEval(S)}else f[p]=new Code(S,{});a+=d;break;case BSON.BSON_DATA_CODE_W_SCOPE:var d=(t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24,t[a++]|t[a++]<<8|t[a++]<<16|t[a++]<<24),S=supportsBuffer&&Buffer.isBuffer(t)?t.toString("utf8",a,a+d-1):convertUint8ArrayToUtf8String(t,a,a+d-1);a+=d,e.index=a;var w=t[a]|t[a+1]<<8|t[a+2]<<16|t[a+3]<<24,T=BSON.deserialize(t,e,!1);if(a+=w,n){if(i){var N=o?crc32(S):S;f[p]=isolateEvalWithHash(functionCache,N,S,f)}else f[p]=isolateEval(S);f[p].scope=T}else f[p]=new Code(S,T)}}return null!=f.$id&&(f=new DBRef(f.$ref,f.$id,f.$db)),f},BSON.checkKey=function(t,e){if(t.length){if(~t.indexOf("\x00"))throw Error("key "+t+" must not contain null bytes");if(!e){if("$"==t[0])throw Error("key "+t+" must not start with '$'");if(~t.indexOf("."))throw Error("key "+t+" must not contain '.'")}}},BSON.prototype.deserialize=function(t,e){return BSON.deserialize(t,e)},BSON.prototype.deserializeStream=function(t,e,r,n,i,o){return BSON.deserializeStream(t,e,r,n,i,o)},BSON.prototype.serialize=function(t,e,r,n){return BSON.serialize(t,e,r,n)},BSON.prototype.calculateObjectSize=function(t,e){return BSON.calculateObjectSize(t,e)},BSON.prototype.serializeWithBufferAndIndex=function(t,e,r,n,i){return BSON.serializeWithBufferAndIndex(t,e,r,n,i)},exports.Code=Code,exports.Symbol=Symbol,exports.BSON=BSON,exports.DBRef=DBRef,exports.Binary=Binary,exports.ObjectID=ObjectID,exports.Long=Long,exports.Timestamp=Timestamp,exports.Double=Double,exports.MinKey=MinKey,exports.MaxKey=MaxKey}).call(this,require("buffer").Buffer)},{"./binary":52,"./binary_parser":53,"./code":55,"./db_ref":56,"./double":57,"./float_parser":58,"./long":59,"./max_key":60,"./min_key":61,"./objectid":62,"./symbol":63,"./timestamp":64,buffer:40}],55:[function(t,e){var r=function t(e,r){return this instanceof t?(this._bsontype="Code",this.code=e,void(this.scope=null==r?{}:r)):new t(e,r)};r.prototype.toJSON=function(){return{scope:this.scope,code:this.code}},e.exports=r,e.exports.Code=r},{}],56:[function(t,e){function r(t,e,n){return this instanceof r?(this._bsontype="DBRef",this.namespace=t,this.oid=e,void(this.db=n)):new r(t,e,n)}r.prototype.toJSON=function(){return{$ref:this.namespace,$id:this.oid,$db:null==this.db?"":this.db}},e.exports=r,e.exports.DBRef=r},{}],57:[function(t,e){function r(t){return this instanceof r?(this._bsontype="Double",void(this.value=t)):new r(t)}r.prototype.valueOf=function(){return this.value},r.prototype.toJSON=function(){return this.value},e.exports=r,e.exports.Double=r},{}],58:[function(t,e,r){var n=function(t,e,r,n,i){var o,s,a="big"===r,u=8*i-n-1,f=(1<<u)-1,c=f>>1,h=-7,p=a?0:i-1,l=a?1:-1,d=t[e+p];for(p+=l,o=d&(1<<-h)-1,d>>=-h,h+=u;h>0;o=256*o+t[e+p],p+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=n;h>0;s=256*s+t[e+p],p+=l,h-=8);if(0===o)o=1-c;else{if(o===f)return s?0/0:1/0*(d?-1:1);s+=Math.pow(2,n),o-=c}return(d?-1:1)*s*Math.pow(2,o-n)},i=function(t,e,r,n,i,o){var s,a,u,f="big"===n,c=8*o-i-1,h=(1<<c)-1,p=h>>1,l=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=f?o-1:0,y=f?-1:1,g=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||1/0===e?(a=isNaN(e)?1:0,s=h):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+p>=1?l/u:l*Math.pow(2,1-p),e*u>=2&&(s++,u/=2),s+p>=h?(a=0,s=h):s+p>=1?(a=(e*u-1)*Math.pow(2,i),s+=p):(a=e*Math.pow(2,p-1)*Math.pow(2,i),s=0));i>=8;t[r+d]=255&a,d+=y,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;t[r+d]=255&s,d+=y,s/=256,c-=8);t[r+d-y]|=128*g};r.readIEEE754=n,r.writeIEEE754=i},{}],59:[function(t,e){function r(t,e){return this instanceof r?(this._bsontype="Long",this.low_=0|t,void(this.high_=0|e)):new r(t,e)}r.prototype.toInt=function(){return this.low_},r.prototype.toNumber=function(){return this.high_*r.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},r.prototype.toJSON=function(){return this.toString()},r.prototype.toString=function(t){var e=t||10;if(2>e||e>36)throw Error("radix out of range: "+e);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(r.MIN_VALUE)){var n=r.fromNumber(e),i=this.div(n),o=i.multiply(n).subtract(this);return i.toString(e)+o.toInt().toString(e)}return"-"+this.negate().toString(e)}for(var s=r.fromNumber(Math.pow(e,6)),o=this,a="";;){var u=o.div(s),f=o.subtract(u.multiply(s)).toInt(),c=f.toString(e);if(o=u,o.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},r.prototype.getHighBits=function(){return this.high_},r.prototype.getLowBits=function(){return this.low_},r.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:r.TWO_PWR_32_DBL_+this.low_},r.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(r.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var t=0!=this.high_?this.high_:this.low_,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high_?e+33:e+1},r.prototype.isZero=function(){return 0==this.high_&&0==this.low_},r.prototype.isNegative=function(){return this.high_<0},r.prototype.isOdd=function(){return 1==(1&this.low_)},r.prototype.equals=function(t){return this.high_==t.high_&&this.low_==t.low_},r.prototype.notEquals=function(t){return this.high_!=t.high_||this.low_!=t.low_},r.prototype.lessThan=function(t){return this.compare(t)<0},r.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},r.prototype.greaterThan=function(t){return this.compare(t)>0},r.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},r.prototype.compare=function(t){if(this.equals(t))return 0;var e=this.isNegative(),r=t.isNegative();return e&&!r?-1:!e&&r?1:this.subtract(t).isNegative()?-1:1},r.prototype.negate=function(){return this.equals(r.MIN_VALUE)?r.MIN_VALUE:this.not().add(r.ONE)},r.prototype.add=function(t){var e=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,o=65535&this.low_,s=t.high_>>>16,a=65535&t.high_,u=t.low_>>>16,f=65535&t.low_,c=0,h=0,p=0,l=0;return l+=o+f,p+=l>>>16,l&=65535,p+=i+u,h+=p>>>16,p&=65535,h+=n+a,c+=h>>>16,h&=65535,c+=e+s,c&=65535,r.fromBits(p<<16|l,c<<16|h)},r.prototype.subtract=function(t){return this.add(t.negate())},r.prototype.multiply=function(t){if(this.isZero())return r.ZERO;if(t.isZero())return r.ZERO;if(this.equals(r.MIN_VALUE))return t.isOdd()?r.MIN_VALUE:r.ZERO;if(t.equals(r.MIN_VALUE))return this.isOdd()?r.MIN_VALUE:r.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(r.TWO_PWR_24_)&&t.lessThan(r.TWO_PWR_24_))return r.fromNumber(this.toNumber()*t.toNumber());var e=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,o=65535&this.low_,s=t.high_>>>16,a=65535&t.high_,u=t.low_>>>16,f=65535&t.low_,c=0,h=0,p=0,l=0;return l+=o*f,p+=l>>>16,l&=65535,p+=i*f,h+=p>>>16,p&=65535,p+=o*u,h+=p>>>16,p&=65535,h+=n*f,c+=h>>>16,h&=65535,h+=i*u,c+=h>>>16,h&=65535,h+=o*a,c+=h>>>16,h&=65535,c+=e*f+n*u+i*a+o*s,c&=65535,r.fromBits(p<<16|l,c<<16|h)},r.prototype.div=function(t){if(t.isZero())throw Error("division by zero");if(this.isZero())return r.ZERO;if(this.equals(r.MIN_VALUE)){if(t.equals(r.ONE)||t.equals(r.NEG_ONE))return r.MIN_VALUE;if(t.equals(r.MIN_VALUE))return r.ONE;var e=this.shiftRight(1),n=e.div(t).shiftLeft(1);if(n.equals(r.ZERO))return t.isNegative()?r.ONE:r.NEG_ONE;var i=this.subtract(t.multiply(n)),o=n.add(i.div(t));return o}if(t.equals(r.MIN_VALUE))return r.ZERO;if(this.isNegative())return t.isNegative()?this.negate().div(t.negate()):this.negate().div(t).negate();if(t.isNegative())return this.div(t.negate()).negate();for(var s=r.ZERO,i=this;i.greaterThanOrEqual(t);){for(var n=Math.max(1,Math.floor(i.toNumber()/t.toNumber())),a=Math.ceil(Math.log(n)/Math.LN2),u=48>=a?1:Math.pow(2,a-48),f=r.fromNumber(n),c=f.multiply(t);c.isNegative()||c.greaterThan(i);)n-=u,f=r.fromNumber(n),c=f.multiply(t);f.isZero()&&(f=r.ONE),s=s.add(f),i=i.subtract(c)}return s},r.prototype.modulo=function(t){return this.subtract(this.div(t).multiply(t))},r.prototype.not=function(){return r.fromBits(~this.low_,~this.high_)},r.prototype.and=function(t){return r.fromBits(this.low_&t.low_,this.high_&t.high_)},r.prototype.or=function(t){return r.fromBits(this.low_|t.low_,this.high_|t.high_)},r.prototype.xor=function(t){return r.fromBits(this.low_^t.low_,this.high_^t.high_)},r.prototype.shiftLeft=function(t){if(t&=63,0==t)return this;var e=this.low_;if(32>t){var n=this.high_;return r.fromBits(e<<t,n<<t|e>>>32-t)}return r.fromBits(0,e<<t-32)},r.prototype.shiftRight=function(t){if(t&=63,0==t)return this;var e=this.high_;if(32>t){var n=this.low_;return r.fromBits(n>>>t|e<<32-t,e>>t)}return r.fromBits(e>>t-32,e>=0?0:-1)},r.prototype.shiftRightUnsigned=function(t){if(t&=63,0==t)return this;var e=this.high_;if(32>t){var n=this.low_;return r.fromBits(n>>>t|e<<32-t,e>>>t)}return 32==t?r.fromBits(e,0):r.fromBits(e>>>t-32,0)},r.fromInt=function(t){if(t>=-128&&128>t){var e=r.INT_CACHE_[t];if(e)return e}var n=new r(0|t,0>t?-1:0);return t>=-128&&128>t&&(r.INT_CACHE_[t]=n),n},r.fromNumber=function(t){return isNaN(t)||!isFinite(t)?r.ZERO:t<=-r.TWO_PWR_63_DBL_?r.MIN_VALUE:t+1>=r.TWO_PWR_63_DBL_?r.MAX_VALUE:0>t?r.fromNumber(-t).negate():new r(t%r.TWO_PWR_32_DBL_|0,t/r.TWO_PWR_32_DBL_|0)},r.fromBits=function(t,e){return new r(t,e)},r.fromString=function(t,e){if(0==t.length)throw Error("number format error: empty string");var n=e||10;if(2>n||n>36)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return r.fromString(t.substring(1),n).negate();if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+t);for(var i=r.fromNumber(Math.pow(n,8)),o=r.ZERO,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),u=parseInt(t.substring(s,s+a),n);if(8>a){var f=r.fromNumber(Math.pow(n,a));o=o.multiply(f).add(r.fromNumber(u))}else o=o.multiply(i),o=o.add(r.fromNumber(u))}return o},r.INT_CACHE_={},r.TWO_PWR_16_DBL_=65536,r.TWO_PWR_24_DBL_=1<<24,r.TWO_PWR_32_DBL_=r.TWO_PWR_16_DBL_*r.TWO_PWR_16_DBL_,r.TWO_PWR_31_DBL_=r.TWO_PWR_32_DBL_/2,r.TWO_PWR_48_DBL_=r.TWO_PWR_32_DBL_*r.TWO_PWR_16_DBL_,r.TWO_PWR_64_DBL_=r.TWO_PWR_32_DBL_*r.TWO_PWR_32_DBL_,r.TWO_PWR_63_DBL_=r.TWO_PWR_64_DBL_/2,r.ZERO=r.fromInt(0),r.ONE=r.fromInt(1),r.NEG_ONE=r.fromInt(-1),r.MAX_VALUE=r.fromBits(-1,2147483647),r.MIN_VALUE=r.fromBits(0,-2147483648),r.TWO_PWR_24_=r.fromInt(1<<24),e.exports=r,e.exports.Long=r},{}],60:[function(t,e){function r(){return this instanceof r?void(this._bsontype="MaxKey"):new r}e.exports=r,e.exports.MaxKey=r},{}],61:[function(t,e){function r(){return this instanceof r?void(this._bsontype="MinKey"):new r}e.exports=r,e.exports.MinKey=r},{}],62:[function(t,e){(function(r){for(var n=t("./binary_parser").BinaryParser,i=parseInt(16777215*Math.random(),10),o=new RegExp("^[0-9a-fA-F]{24}$"),s=function t(e){if(!(this instanceof t))return new t(e);if(e instanceof t)return e;this._bsontype="ObjectID";var r=t.isValid(e);if(!r&&null!=e)throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return r&&"string"==typeof e&&24==e.length?t.createFromHexString(e):(null==e||"number"==typeof e?this.id=this.generate(e):null!=e&&12===e.length&&(this.id=e),void(t.cacheHexString&&(this.__id=this.toHexString())))},a=[],u=0;256>u;u++)a[u]=(15>=u?"0":"")+u.toString(16);s.prototype.toHexString=function(){if(s.cacheHexString&&this.__id)return this.__id;for(var t="",e=0;e<this.id.length;e++)t+=a[this.id.charCodeAt(e)];return s.cacheHexString&&(this.__id=t),t},s.prototype.get_inc=function(){return s.index=(s.index+1)%16777215},s.prototype.getInc=function(){return this.get_inc()},s.prototype.generate=function(t){"number"!=typeof t&&(t=parseInt(Date.now()/1e3,10));var e=n.encodeInt(t,32,!0,!0),o=n.encodeInt(i,24,!1),s=n.fromShort("undefined"==typeof r?Math.floor(1e5*Math.random()):r.pid%65535),a=n.encodeInt(this.get_inc(),24,!1,!0);return e+o+s+a},s.prototype.toString=function(){return this.toHexString()},s.prototype.inspect=s.prototype.toString,s.prototype.toJSON=function(){return this.toHexString()},s.prototype.equals=function(t){if(null==t)return!1;var e=t instanceof s||t.toHexString?t.id:s.createFromHexString(t).id;return this.id===e},s.prototype.getTimestamp=function(){var t=new Date;return t.setTime(1e3*Math.floor(n.decodeInt(this.id.substring(0,4),32,!0,!0))),t},s.index=parseInt(16777215*Math.random(),10),s.createPk=function(){return new s},s.createFromTime=function(t){var e=n.encodeInt(t,32,!0,!0)+n.encodeInt(0,64,!0,!0);return new s(e)},s.createFromHexString=function(t){if("undefined"==typeof t||null!=t&&24!=t.length)throw new Error("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");var e=t.length;if(e>24)throw new Error("Id cannot be longer than 12 bytes");for(var r,i,o="",a=0;e>a;a+=2)r=t.substr(a,2),i=parseInt(r,16),o+=n.fromByte(i);return new s(o,t)},s.isValid=function(t){return null==t?!1:null!=t&&"number"!=typeof t&&12!=t.length&&24!=t.length?!1:"string"==typeof t&&24==t.length?o.test(t):!0},Object.defineProperty(s.prototype,"generationTime",{enumerable:!0,get:function(){return Math.floor(n.decodeInt(this.id.substring(0,4),32,!0,!0))},set:function(t){var t=n.encodeInt(t,32,!0,!0);this.id=t+this.id.substr(4),this.toHexString()}}),e.exports=s,e.exports.ObjectID=s,e.exports.ObjectId=s}).call(this,t("FWaASH"))},{"./binary_parser":53,FWaASH:46}],63:[function(t,e){function r(t){return this instanceof r?(this._bsontype="Symbol",void(this.value=t)):new r(t)}r.prototype.valueOf=function(){return this.value},r.prototype.toString=function(){return this.value},r.prototype.inspect=function(){return this.value},r.prototype.toJSON=function(){return this.value},e.exports=r,e.exports.Symbol=r},{}],64:[function(t,e){function r(t,e){return this instanceof r?(this._bsontype="Timestamp",this.low_=0|t,void(this.high_=0|e)):new r(t,e)}r.prototype.toInt=function(){return this.low_},r.prototype.toNumber=function(){return this.high_*r.TWO_PWR_32_DBL_+this.getLowBitsUnsigned()},r.prototype.toJSON=function(){return this.toString()},r.prototype.toString=function(t){var e=t||10;if(2>e||e>36)throw Error("radix out of range: "+e);if(this.isZero())return"0";if(this.isNegative()){if(this.equals(r.MIN_VALUE)){var n=r.fromNumber(e),i=this.div(n),o=i.multiply(n).subtract(this);return i.toString(e)+o.toInt().toString(e)}return"-"+this.negate().toString(e)}for(var s=r.fromNumber(Math.pow(e,6)),o=this,a="";;){var u=o.div(s),f=o.subtract(u.multiply(s)).toInt(),c=f.toString(e);if(o=u,o.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},r.prototype.getHighBits=function(){return this.high_},r.prototype.getLowBits=function(){return this.low_},r.prototype.getLowBitsUnsigned=function(){return this.low_>=0?this.low_:r.TWO_PWR_32_DBL_+this.low_},r.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(r.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var t=0!=this.high_?this.high_:this.low_,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high_?e+33:e+1},r.prototype.isZero=function(){return 0==this.high_&&0==this.low_},r.prototype.isNegative=function(){return this.high_<0},r.prototype.isOdd=function(){return 1==(1&this.low_)},r.prototype.equals=function(t){return this.high_==t.high_&&this.low_==t.low_},r.prototype.notEquals=function(t){return this.high_!=t.high_||this.low_!=t.low_},r.prototype.lessThan=function(t){return this.compare(t)<0},r.prototype.lessThanOrEqual=function(t){return this.compare(t)<=0},r.prototype.greaterThan=function(t){return this.compare(t)>0},r.prototype.greaterThanOrEqual=function(t){return this.compare(t)>=0},r.prototype.compare=function(t){if(this.equals(t))return 0;var e=this.isNegative(),r=t.isNegative();return e&&!r?-1:!e&&r?1:this.subtract(t).isNegative()?-1:1},r.prototype.negate=function(){return this.equals(r.MIN_VALUE)?r.MIN_VALUE:this.not().add(r.ONE)},r.prototype.add=function(t){var e=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,o=65535&this.low_,s=t.high_>>>16,a=65535&t.high_,u=t.low_>>>16,f=65535&t.low_,c=0,h=0,p=0,l=0;return l+=o+f,p+=l>>>16,l&=65535,p+=i+u,h+=p>>>16,p&=65535,h+=n+a,c+=h>>>16,h&=65535,c+=e+s,c&=65535,r.fromBits(p<<16|l,c<<16|h)},r.prototype.subtract=function(t){return this.add(t.negate())},r.prototype.multiply=function(t){if(this.isZero())return r.ZERO;if(t.isZero())return r.ZERO;if(this.equals(r.MIN_VALUE))return t.isOdd()?r.MIN_VALUE:r.ZERO;if(t.equals(r.MIN_VALUE))return this.isOdd()?r.MIN_VALUE:r.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(r.TWO_PWR_24_)&&t.lessThan(r.TWO_PWR_24_))return r.fromNumber(this.toNumber()*t.toNumber());var e=this.high_>>>16,n=65535&this.high_,i=this.low_>>>16,o=65535&this.low_,s=t.high_>>>16,a=65535&t.high_,u=t.low_>>>16,f=65535&t.low_,c=0,h=0,p=0,l=0;return l+=o*f,p+=l>>>16,l&=65535,p+=i*f,h+=p>>>16,p&=65535,p+=o*u,h+=p>>>16,p&=65535,h+=n*f,c+=h>>>16,h&=65535,h+=i*u,c+=h>>>16,h&=65535,h+=o*a,c+=h>>>16,h&=65535,c+=e*f+n*u+i*a+o*s,c&=65535,r.fromBits(p<<16|l,c<<16|h)},r.prototype.div=function(t){if(t.isZero())throw Error("division by zero");if(this.isZero())return r.ZERO;if(this.equals(r.MIN_VALUE)){if(t.equals(r.ONE)||t.equals(r.NEG_ONE))return r.MIN_VALUE;if(t.equals(r.MIN_VALUE))return r.ONE;var e=this.shiftRight(1),n=e.div(t).shiftLeft(1);if(n.equals(r.ZERO))return t.isNegative()?r.ONE:r.NEG_ONE;var i=this.subtract(t.multiply(n)),o=n.add(i.div(t));return o}if(t.equals(r.MIN_VALUE))return r.ZERO;if(this.isNegative())return t.isNegative()?this.negate().div(t.negate()):this.negate().div(t).negate();if(t.isNegative())return this.div(t.negate()).negate();for(var s=r.ZERO,i=this;i.greaterThanOrEqual(t);){for(var n=Math.max(1,Math.floor(i.toNumber()/t.toNumber())),a=Math.ceil(Math.log(n)/Math.LN2),u=48>=a?1:Math.pow(2,a-48),f=r.fromNumber(n),c=f.multiply(t);c.isNegative()||c.greaterThan(i);)n-=u,f=r.fromNumber(n),c=f.multiply(t);f.isZero()&&(f=r.ONE),s=s.add(f),i=i.subtract(c)}return s},r.prototype.modulo=function(t){return this.subtract(this.div(t).multiply(t))},r.prototype.not=function(){return r.fromBits(~this.low_,~this.high_)},r.prototype.and=function(t){return r.fromBits(this.low_&t.low_,this.high_&t.high_)},r.prototype.or=function(t){return r.fromBits(this.low_|t.low_,this.high_|t.high_)},r.prototype.xor=function(t){return r.fromBits(this.low_^t.low_,this.high_^t.high_)},r.prototype.shiftLeft=function(t){if(t&=63,0==t)return this;var e=this.low_;if(32>t){var n=this.high_;return r.fromBits(e<<t,n<<t|e>>>32-t)}return r.fromBits(0,e<<t-32)},r.prototype.shiftRight=function(t){if(t&=63,0==t)return this;var e=this.high_;if(32>t){var n=this.low_;return r.fromBits(n>>>t|e<<32-t,e>>t)}return r.fromBits(e>>t-32,e>=0?0:-1)},r.prototype.shiftRightUnsigned=function(t){if(t&=63,0==t)return this;var e=this.high_;if(32>t){var n=this.low_;return r.fromBits(n>>>t|e<<32-t,e>>>t)}return 32==t?r.fromBits(e,0):r.fromBits(e>>>t-32,0)},r.fromInt=function(t){if(t>=-128&&128>t){var e=r.INT_CACHE_[t];if(e)return e}var n=new r(0|t,0>t?-1:0);return t>=-128&&128>t&&(r.INT_CACHE_[t]=n),n},r.fromNumber=function(t){return isNaN(t)||!isFinite(t)?r.ZERO:t<=-r.TWO_PWR_63_DBL_?r.MIN_VALUE:t+1>=r.TWO_PWR_63_DBL_?r.MAX_VALUE:0>t?r.fromNumber(-t).negate():new r(t%r.TWO_PWR_32_DBL_|0,t/r.TWO_PWR_32_DBL_|0)},r.fromBits=function(t,e){return new r(t,e)},r.fromString=function(t,e){if(0==t.length)throw Error("number format error: empty string");var n=e||10;if(2>n||n>36)throw Error("radix out of range: "+n);
if("-"==t.charAt(0))return r.fromString(t.substring(1),n).negate();if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character: '+t);for(var i=r.fromNumber(Math.pow(n,8)),o=r.ZERO,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),u=parseInt(t.substring(s,s+a),n);if(8>a){var f=r.fromNumber(Math.pow(n,a));o=o.multiply(f).add(r.fromNumber(u))}else o=o.multiply(i),o=o.add(r.fromNumber(u))}return o},r.INT_CACHE_={},r.TWO_PWR_16_DBL_=65536,r.TWO_PWR_24_DBL_=1<<24,r.TWO_PWR_32_DBL_=r.TWO_PWR_16_DBL_*r.TWO_PWR_16_DBL_,r.TWO_PWR_31_DBL_=r.TWO_PWR_32_DBL_/2,r.TWO_PWR_48_DBL_=r.TWO_PWR_32_DBL_*r.TWO_PWR_16_DBL_,r.TWO_PWR_64_DBL_=r.TWO_PWR_32_DBL_*r.TWO_PWR_32_DBL_,r.TWO_PWR_63_DBL_=r.TWO_PWR_64_DBL_/2,r.ZERO=r.fromInt(0),r.ONE=r.fromInt(1),r.NEG_ONE=r.fromInt(-1),r.MAX_VALUE=r.fromBits(-1,2147483647),r.MIN_VALUE=r.fromBits(0,-2147483648),r.TWO_PWR_24_=r.fromInt(1<<24),e.exports=r,e.exports.Timestamp=r},{}],65:[function(t,e,r){e.exports=r=t("./lib")},{"./lib":66}],66:[function(t,e,r){function n(t){return t}r.get=function(t,e,i,o){"function"==typeof i&&(o=i,i=void 0),o||(o=n);var s="string"==typeof t?t.split("."):t;if(!Array.isArray(s))throw new TypeError("Invalid `path`. Must be either string or array");for(var a,u=e,f=0;f<s.length;++f){if(a=s[f],Array.isArray(u)&&!/^\d+$/.test(a)){var c=s.slice(f);return u.map(function(t){return t?r.get(c,t,i,o):o(void 0)})}if(u=i&&u[i]?u[i][a]:u[a],!u)return o(u)}return o(u)},r.set=function(t,e,i,o,s,a){"function"==typeof o&&(s=o,o=void 0),s||(s=n);var u="string"==typeof t?t.split("."):t;if(!Array.isArray(u))throw new TypeError("Invalid `path`. Must be either string or array");if(null!=i){for(var f,c=a||/\$/.test(t),h=i,p=0,l=u.length-1;l>p;++p)if(f=u[p],"$"!=f){if(Array.isArray(h)&&!/^\d+$/.test(f)){var d=u.slice(p);if(!c&&Array.isArray(e))for(var y=0;y<h.length&&y<e.length;++y)r.set(d,e[y],h[y],o,s,c);else for(var y=0;y<h.length;++y)r.set(d,e,h[y],o,s,c);return}if(h=o&&h[o]?h[o][f]:h[f],!h)return}else if(p==l-1)break;if(f=u[l],o&&h[o]&&(h=h[o]),Array.isArray(h)&&!/^\d+$/.test(f))if(!c&&Array.isArray(e))for(var g,y=0;y<h.length&&y<e.length;++y)g=h[y],g&&(g[o]&&(g=g[o]),g[f]=s(e[y]));else for(var y=0;y<h.length;++y)g=h[y],g&&(g[o]&&(g=g[o]),g[f]=s(e));else h[f]=s(e)}}},{}],67:[function(t,e){(function(r){"use strict";function n(t,e,r){return Array.prototype.slice.call(t,e,r)}function i(t,e){var r=n(e);return r.unshift(t),r}function o(t){this.emitter=new u,this.emitted={},this.ended=!1,"function"==typeof t&&this.onResolve(t)}function s(t,e){function n(){var n=t.emitter.domain;n&&n!==r.domain&&n.enter();try{var o=e.apply(void 0,i.args)}catch(e){return void t.reject(e)}a(t,o)}function i(){i.args=arguments,r.nextTick(n)}return i}function a(t,e){function r(){c++||a.apply(void 0,i(t,arguments))}function o(e){c++||t.reject(e)}if(t===e)return void t.reject(new TypeError("promise and x are the same"));var s=n(arguments,1),u=typeof e;if("undefined"==u||null==e||"object"!=u&&"function"!=u)return void t.fulfill.apply(t,s);try{var f=e.then}catch(e){return void t.reject(e)}if("function"!=typeof f)return void t.fulfill.apply(t,s);var c=0;try{var h=f.call(e,r,o);return h}catch(e){if(c++)return;t.reject(e)}}var u=(t("util"),t("events").EventEmitter);e.exports=o,o.SUCCESS="fulfill",o.FAILURE="reject",o.prototype.on=function(t,e){return this.emitted[t]?e.apply(void 0,this.emitted[t]):this.emitter.on(t,e),this},o.prototype.safeEmit=function(t){if(t==o.SUCCESS||t==o.FAILURE){if(this.emitted[o.SUCCESS]||this.emitted[o.FAILURE])return this;this.emitted[t]=n(arguments,1)}return this.emitter.emit.apply(this.emitter,arguments),this},o.prototype.fulfill=function(){return this.safeEmit.apply(this,i(o.SUCCESS,arguments))},o.prototype.reject=function(t){if(this.ended&&!this.hasRejectListeners())throw t;return this.safeEmit(o.FAILURE,t)},o.prototype.resolve=function(t,e){return t?this.reject(t):this.fulfill(e)},o.prototype.onFulfill=function(t){if(!t)return this;if("function"!=typeof t)throw new TypeError("fn should be a function");return this.on(o.SUCCESS,t)},o.prototype.hasRejectListeners=function(){return this.emitter.listeners(o.FAILURE).length>0},o.prototype.onReject=function(t){if(!t)return this;if("function"!=typeof t)throw new TypeError("fn should be a function");return this.on(o.FAILURE,t)},o.prototype.onResolve=function(t){if(this.end(),!t)return this;if("function"!=typeof t)throw new TypeError("fn should be a function");return this.on(o.FAILURE,function(e){t.call(this,e)}),this.on(o.SUCCESS,function(){t.apply(this,i(null,arguments))}),this},o.prototype.then=function(t,e){var r=new o;return this.onFulfill("function"==typeof t?s(r,t):r.fulfill.bind(r)),this.onReject("function"==typeof e?s(r,e):r.reject.bind(r)),r},o.prototype.end=function(t){return this.onReject(t),this.ended=!0,this},o.trace=function(t,e){t.then(function(){console.log("%s fulfill %j",e,n(arguments))},function(){console.log("%s reject %j",e,n(arguments))})},o.prototype.chain=function(t){var e=this;return e.onFulfill(t.fulfill.bind(t)),e.onReject(t.reject.bind(t)),t},o.prototype.all=function(t){var e=new o;return this.then(t).then(function(t){var r,n=0,i=[];return t.length||e.resolve(),t.forEach(function(t,o){r||(n++,t.then(function(t){r||(i[o]=t,--n,0==n&&e.fulfill(i))},function(t){r||(r=t,e.reject(t))}))}),e},e.reject.bind(e)),e},o.hook=function(t){var e=new o,r=new o,n=function(){return--i,0==i&&r.fulfill(),r},i=1,s=e;return t.forEach(function(t){s=s.then(function(){var e=new o;return i++,t(e.resolve.bind(e),n),e})}),s=s.then(n),e.resolve(),s},o.fulfilled=function(){var t=new o;return t.fulfill.apply(t,arguments),t},o.rejected=function(t){return(new o).reject(t)},o.deferred=function(){var t=new o;return{promise:t,reject:t.reject.bind(t),resolve:t.fulfill.bind(t),callback:t.resolve.bind(t)}}}).call(this,t("FWaASH"))},{FWaASH:46,events:44,util:48}],68:[function(t,e){!function(t){function r(t){return t==Number(t)?Number(t):(n.exec(t.toLowerCase()),RegExp.$1*i[RegExp.$2])}var n=/(\d*.?\d+)([mshd]+)/,i={};i.ms=1,i.s=1e3,i.m=60*i.s,i.h=60*i.m,i.d=24*i.h,t.top?t.ms=r:e.exports=r}(this)},{}],69:[function(t,e,r){function n(t){return"object"==typeof t&&"[object RegExp]"==i.call(t)}var i=Object.prototype.toString;e.exports=r=function(t){if(!n(t))throw new TypeError("Not a RegExp");var e=[];return t.global&&e.push("g"),t.multiline&&e.push("m"),t.ignoreCase&&e.push("i"),new RegExp(t.source,e.join(""))}},{}],70:[function(t,e,r){e.exports=r=t("./lib/sliced")},{"./lib/sliced":71}],71:[function(t,e){e.exports=function(t,e,r){var n=[],i=t.length;if(0===i)return n;var o=0>e?Math.max(0,e+i):e||0;for(void 0!==r&&(i=0>r?r+i:r);i-->o;)n[i-o]=t[i];return n}},{}]},{},[1]);